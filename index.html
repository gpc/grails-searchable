<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>Searchable Grails Plugin</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Searchable Grails Plugin</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_quick_start">Quick start</a></li>
<li><a href="#_searchablecontroller_and_view">SearchableController and view</a></li>
<li><a href="#_searching">Searching</a>
<ul class="sectlevel2">
<li><a href="#_query_builder">Query Builder</a></li>
<li><a href="#_sorting">Sorting</a></li>
</ul>
</li>
<li><a href="#_mapping">Mapping</a>
<ul class="sectlevel2">
<li><a href="#_not_all_properties">Not All Properties</a></li>
<li><a href="#_mapping_conventions">Mapping conventions</a></li>
<li><a href="#_compass_concepts">Compass concepts</a></li>
<li><a href="#_mapping_dsl">Mapping DSL</a></li>
<li><a href="#_class_property_mapping">Class Property Mapping</a></li>
<li><a href="#_searchable_id">Searchable Id</a></li>
<li><a href="#_searchable_property_2">Searchable Property</a></li>
<li><a href="#_searchable_reference_2">Searchable Reference</a></li>
<li><a href="#_searchable_component_2">Searchable Component</a></li>
<li><a href="#_class_mapping">Class Mapping</a></li>
<li><a href="#_compass_annotations">Compass annotations</a></li>
</ul>
</li>
<li><a href="#_configuration">Configuration</a></li>
<li><a href="#_analyzers">Analyzers</a></li>
<li><a href="#_converters">Converters</a></li>
<li><a href="#_debugging">Debugging</a></li>
<li><a href="#_faq">FAQ</a></li>
<li><a href="#_methods">Methods</a>
<ul class="sectlevel2">
<li><a href="#_search">search</a></li>
<li><a href="#_counthits">countHits</a></li>
<li><a href="#_morelikethis">moreLikeThis</a></li>
<li><a href="#_suggestquery">suggestQuery</a></li>
<li><a href="#_termfreqs">termFreqs</a></li>
<li><a href="#_index">index</a></li>
<li><a href="#_unindex">unindex</a></li>
<li><a href="#_reindex">reindex</a></li>
<li><a href="#_rebuildspellingsuggestions">rebuildSpellingSuggestions</a></li>
<li><a href="#_startmirroring">startMirroring</a></li>
<li><a href="#_stopmirroring">stopMirroring</a></li>
</ul>
</li>
<li><a href="#_releases">Releases</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_quick_start">Quick start</h2>
<div class="sectionbody">
<h3 id="_install_the_plugin" class="discrete">Install the plugin</h3>
<div class="paragraph">
<p>JDK 1.5+ users:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails install-plugin searchable</pre>
</div>
</div>
<div class="paragraph">
<p>JDK 1.4 users:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails install-plugin searchable14</pre>
</div>
</div>
<h3 id="_define_searchable_classes" class="discrete">Define Searchable classes</h3>
<div class="paragraph">
<p>Add a static <strong>searchable</strong> property to the domain classes you want to be stored in the search index, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    static searchable = true              // &lt;-- Make Posts searchable
    static hasMany = [comments: Comment]
    String category, title, post
    User author
    Date createdAt
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>class Comment {
    static searchable = true              // &lt;-- Make Comments searchable
    static belongsTo = [post: Post]
    String comment
    Post post
    User user
    Date createdAt
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>class User {
    static searchable = true              // &lt;-- Make Users searchable
    static hasMany = [posts: Post]
    String username, password
}</pre>
</div>
</div>
<div class="paragraph">
<p>Declaring <strong>static searchable = true</strong> is the simplest way to define your [searchable class mappings|Searchable Plugin - Mapping].</p>
</div>
<div class="paragraph">
<p>In some cases during implementation with Grails 2.3, Searchable Plugin 0.6.6, i had end up with Issue unable tp locate org.compass-project:compass:2.2.1.
Refer to this tutorial for the set up in case you are facing such issues with 2.3 Grails version. [<a href="http://jolorenz.wordpress.com/2013/10/02/how-to-use-searchable-plugin-with-grails-2-3-0-and-hibernate-4-x/" class="bare">http://jolorenz.wordpress.com/2013/10/02/how-to-use-searchable-plugin-with-grails-2-3-0-and-hibernate-4-x/</a>]</p>
</div>
<h3 id="_try_it" class="discrete">Try it!</h3>
<div class="paragraph">
<p>Fire up your app&#8230;&#8203; <em>during startup the plugin will build the search index all for searchable class instances in your database</em> .</p>
</div>
<div class="paragraph">
<p>Navigate to [<a href="http://localhost:8080/YOUR-APP-NAME-HERE/searchable" class="bare">http://localhost:8080/YOUR-APP-NAME-HERE/searchable</a>], and try a few queries.</p>
</div>
<div class="paragraph">
<p>You just made your domain <em>searchable</em> !</p>
</div>
<h2 id="_next_steps" class="discrete">Next steps</h2>
<div class="paragraph">
<p>Hack the <a href="index.html#_searchablecontroller_and_view">controller and view</a> to your own tastes.</p>
</div>
<div class="paragraph">
<p>Find what you&#8217;re looking for with the simple and powerful <a href="index.html#_searching">search API</a> methods.</p>
</div>
<div class="paragraph">
<p>Customize the <a href="index.html#_mapping">mappings</a> between your classes and the search index.</p>
</div>
<div class="paragraph">
<p>See how to <a href="index.html#_index">manage the index yourself</a> if you need to; normally you do not,
since changes made through Hibernate/GORM are mirrored to the index automatically.</p>
</div>
<div class="paragraph">
<p>Override defaults and more with <a href="index.html#_configuration">configuration</a>: for example, you could increase the search result page size from 10 to 20.</p>
</div>
<div class="paragraph">
<p>Trouble-shoot problems with the <a href="index.html#_debugging">debugging</a> tips and <a href="index.html#_faq">faq</a>.</p>
</div>
<div class="paragraph">
<p>\\
\\
<em>Happy searching</em> !</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_searchablecontroller_and_view">SearchableController and view</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Searchable Plugin comes with a controller <code>SearchableController</code>
and view <code>searchable/index.gsp</code>.
Try these with your application - they can help to test queries
and you can probably copy some of the code.</p>
</div>
<div class="paragraph">
<p>You could use the <code>SearchableController</code> as it comes, but you will probably want a different URL and HTML results page.</p>
</div>
<div class="paragraph">
<p>To change the URL add entries to your <code>grails-app/conf/UrlMappings.groovy</code>.</p>
</div>
<div class="paragraph">
<p>To change the view, you can simply keep the plugin&#8217;s controller and copy <code>myapp/plugins/searchable-x.x/grails-app/views/searchable/index.gsp</code>
to <code>myapp/grails-app/views/searchable/index.gsp</code> where it will override the plugin&#8217;s version.</p>
</div>
<div class="paragraph">
<p>Or of course you can create your own dedicated search controller and view.</p>
</div>
<h3 id="_under_the_covers" class="discrete">Under the covers</h3>
<div class="paragraph">
<p>Here&#8217;s the implementation of the search action from <code>SearchableController</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.compass.core.engine.SearchEngineQueryParseException

// ...

class SearchableController {
    def searchableService

    /**
     * Index page with search form and results
     */
    def index = {
        if (!params.q?.trim()) {
            return [:]
        }
        try {
            return [searchResult: searchableService.search(params.q, params)]
        } catch (SearchEngineQueryParseException ex) {
            return [parseException: true]
        }
    }

    // ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that <code>params.q</code> is the search query string and
<code>params</code> is also given to the <a href="index.html#_searching">search</a> method as
the second argument. This is a <code>Map</code> of <a href="index.html#_searching">options</a>
and are things like page size, start result number, etc.</p>
</div>
<div class="paragraph">
<p>Any String arguments are parsed, so you can use request parameters directly, even when they have string values.
For example, <code>params</code> may be <code>\[escape: "true", offset: "20", q: "toast"\]</code> , but you won&#8217;t get a ClassCastException.</p>
</div>
<h4 id="_pagination_of_search_results_in_the_view" class="discrete">Pagination of search results in the view</h4>
<div class="paragraph">
<p>Search results can be paginated using Grails' standard <code>&lt;g:paginate /&gt;</code> tag.</p>
</div>
<div class="paragraph">
<p>Here it is in action in the Searchable Plugin&#8217;s own search results page, <code>grails-app/views/searchable/index.gsp</code>.
The <code>searchResult</code> is an object returned by either <code>SearchableService#search</code> or <code>DomainClass#search</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;g:if test="${haveResults}"&gt; &lt;!-- or you could use test="${searchResult?.results}" --&gt;
    Page:
    &lt;g:set var="totalPages" value="${Math.ceil(searchResult.total / searchResult.max)}" /&gt;
    &lt;g:if test="${totalPages == 1}"&gt;
        &lt;span class="currentStep"&gt;1&lt;/span&gt;
    &lt;/g:if&gt;
    &lt;g:else&gt;
        &lt;g:paginate controller="searchable" action="index" params="[q: params.q]"
                    total="${searchResult.total}" prev="&amp;lt; previous" next="next &amp;gt;"/&gt;
    &lt;/g:else&gt;
&lt;/g:if&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>And here&#8217;s some CSS to style the generated HTML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.paging a.step {
    padding: 0 .3em;
}

.paging span.currentStep {
    font-weight: bold;
}</pre>
</div>
</div>
<h4 id="_suggested_queries" class="discrete">Suggested queries</h4>
<div class="paragraph">
<p>You can easily highlight the difference between the original and a
[suggested query|Searchable Plugin - Methods - suggestQuery] with the following in a GSP:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;%@ page import="org.codehaus.groovy.grails.plugins.searchable.util.StringQueryUtils" %&gt;

&lt;p&gt;Did you mean
  &lt;g:link controller="searchable" action="index" params="[q: searchResult.suggestedQuery]"&gt;
${StringQueryUtils.highlightTermDiffs(params.q.trim(), searchResult.suggestedQuery)}
  &lt;/g:link&gt;?
&lt;/p&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Which results in something like:</p>
</div>
<div class="paragraph">
<p>Did you mean <a href="http://www.google.com?q=space+invaders">space invader</a>?</p>
</div>
<div class="paragraph">
<p>See this in action in the plugin&#8217;s view.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_searching">Searching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you&#8217;ve outgrown the simple <a href="index.html#_searchablecontroller_and_view">controller and view</a>, you need the search API.</p>
</div>
<div class="paragraph">
<p>The plugin provides search methods with its SearchableService and also adds some to your <em>searchable</em> domain classes.
The available methods are the same but the domain class methods restrict the search space to only that class (or hierarchy).</p>
</div>
<div class="paragraph">
<p>The methods are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="index.html#_searching">search</a></strong> - Find objects matching a query</p>
</li>
<li>
<p><strong><a href="index.html#_counthits">countHits</a></strong> - Find the number of hits for a query</p>
</li>
<li>
<p><strong><a href="index.html#_morelikethis">moreLikeThis</a></strong> - Finds similar objects to the indicated searchable domain class instance</p>
</li>
<li>
<p><strong><a href="index.html#_suggestquery">suggestQuery</a></strong> - Suggest a new search query based on spelling</p>
</li>
<li>
<p><strong><a href="index.html#_termfreqs">termFreqs</a></strong> - Returns term frequencies for the terms in the index</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved directive in index.adoc - include::searching_query_strings.adoc[]</p>
</div>
<div class="sect2">
<h3 id="_query_builder">Query Builder</h3>
<div class="paragraph">
<p>Searchable Plugin comes with a builder, which makes programmatic queries Groovy, baby.</p>
</div>
<div class="paragraph">
<p>When you pass a closure to one of the search methods, you are using the query builder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
TODO the query builder needs a reference section
</td>
</tr>
</table>
</div>
<h4 id="_it_builds_on_compass" class="discrete">It builds on Compass</h4>
<div class="paragraph">
<p>The query builder syntax mirrors Compass&#8217;s own <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassQueryBuilder.html">CompassQueryBuilder</a>: to get the most out of the Searchable Plugin&#8217;s query builder, you should take a moment to familiarise yourself with it.</p>
</div>
<h4 id="_and_makes_it_better" class="discrete">And makes it better</h4>
<div class="paragraph">
<p>The plugin&#8217;s Groovy query builder improves on the raw Compass experience in a few ways. First it relieves you of the burden to call <strong>toQuery()</strong> when using the various specific builders obtained from calling some <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassQueryBuilder.html">CompassQueryBuilder</a> methods, and it allows you to easily nest these specific builders using closures.</p>
</div>
<div class="paragraph">
<p>It also simplifies the job of constructing boolean queries by not requiring you to explicitly create a boolean builder and add "should" clauses. You still need to explicitly add <em>must</em> and <em>must not</em> clauses, but other clauses in a boolean context are assumed to be <em>should</em> clauses.</p>
</div>
<h4 id="_the_rules" class="discrete">The rules</h4>
<div class="paragraph">
<p>The methods you can invoke depend on the current context. In the outer-most context you can invoke <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassQueryBuilder.html">CompassQueryBuilder</a> methods.</p>
</div>
<div class="paragraph">
<p>Within nested contexts (which are created by nested closures) you can call both CompassQueryBuilder methods and whatever methods the current nested builder supports.</p>
</div>
<div class="paragraph">
<p>The builder also allows you to call Compass&#8217;s various query builders' options "setters" using a literal options Map as the last argument, instead of requiring method invocations.</p>
</div>
<div class="paragraph">
<p>The builder shortens a few method names too, so the <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassQueryBuilder.CompassBooleanQueryBuilder.html">CompassBooleanQueryBuilder</a> addMust, addShould, and addMustNot methods can be shortened to must, should, and mustNot (and as already mentioned you typically don&#8217;t need to use should because any clause that is not a must or mustNot is assumed to be should) and the <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassQuery.html">CompassQuery</a> addSort method can be shortedned to sort.</p>
</div>
<div class="paragraph">
<p>And finally because it&#8217;s Groovy, you have the language at your disposal so you can use control flow, loops, variables etc.</p>
</div>
<div class="paragraph">
<p>Enough theory, let&#8217;s explore some examples.</p>
</div>
<h4 id="_by_example" class="discrete">By Example</h4>
<div class="paragraph">
<p>Say you want to search for items in the index where "pages" is less than 50 and "type" is "poetry". A String query for this might look like <strong>"pages:\[\</strong> TO 50\] type:poetry"*.</p>
</div>
<div class="paragraph">
<p>Using the builder you would do</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                    // &lt;-- create an implicit boolean query
    lt("pages", 50)         // &lt;-- uses CompassQueryBuilder#lt, and adds a boolean "should" clause
    term("type", "poetry")  // &lt;-- uses CompassQueryBuilder#term, and adds a boolean "should" clause
}</pre>
</div>
</div>
<div class="paragraph">
<p>We just built a boolean query\! It has two clauses: the search must match EITHER "pages" &lt; 50 OR "type" == "poetry". Not bad but this query will match when <em>either</em> condition is true, and not necessarily both.</p>
</div>
<div class="paragraph">
<p>So let&#8217;s improve the search results and make sure that matches DO have "type" == "poetry".</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                          // &lt;-- creates an implicit boolean query
    lt("pages", 50)               // &lt;-- uses CompassQueryBuilder#lt, and adds a boolean "should"
    must(term("type", "poetry"))  // &lt;-- uses CompassQueryBuilder#term, adds a boolean "must"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Ok let&#8217;s assume we&#8217;re getting matches we don&#8217;t want, and so we add another "mustNot" clause:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                           // &lt;-- creates an implicit boolean query
    lt("pages", 50)                // &lt;-- uses CompassQueryBuilder#lt, and adds a boolean "should"
    must(term("type", "poetry"))   // &lt;-- uses CompassQueryBuilder#term, adds a boolean "must"
    mustNot(term("theme", "war"))  // &lt;-- uses CompassQueryBuilder#term, adds a boolean "mustNot"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Great, so now we&#8217;re matching any non-war poetry under 50 pages\!</p>
</div>
<div class="paragraph">
<p>Now we want to search for a specific phrase "all hands on deck", let&#8217;s add it to the query. First we try it as a nested String query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                                   // &lt;-- creates an implicit boolean query
    must(queryString("all hands on deck")) // &lt;-- uses CompassQueryBuilder#queryString, and adds a boolean must
    lt("pages", 50)                        // &lt;-- uses CompassQueryBuilder#lt, and adds a boolean "should"
    must(term("type", "poetry"))           // &lt;-- uses CompassQueryBuilder#term, adds a boolean "must"
    mustNot(term("theme", "war"))          // &lt;-- uses CompassQueryBuilder#term, adds a boolean "mustNot"
}</pre>
</div>
</div>
<div class="paragraph">
<p>The nested String query has introduced the possibility for the query to matching anything containing any of the words "all", "hands", "on", or "deck" and maybe in any searchable property. But we wanted to search for this exact text, hmmm.</p>
</div>
<div class="paragraph">
<p>Check the <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassQueryBuilder.html">CompassQueryBuilder</a> API and you&#8217;ll notice that CompassQueryBuilder#queryString returns a CompassQueryStringBuilder, so in fact we can create a context for that builder with a closure and in that closure call any methods the CompassQueryStringBuilder exposes to tighten up the query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                                      // &lt;-- creates an implicit boolean query
    must(queryString("all hands on deck") {   // &lt;-- creates a nested CompassQueryStringBuilder context
        useAndDefaultOperator()               // &lt;-- calls CompassQueryStringBuilder#useAndDefaultOperator
        setDefaultSearchProperty("body")      // &lt;-- calls CompassQueryStringBuilder#setDefaultSearchProperty
    })                                        // &lt;-- added as boolean must to surrounding boolean
    lt("pages", 50)                           // &lt;-- uses CompassQueryBuilder#lt, and adds a boolean "should"
    must(term("type", "poetry"))              // &lt;-- uses CompassQueryBuilder#term, adds a boolean "must"
    mustNot(term("theme", "war"))             // &lt;-- uses CompassQueryBuilder#term, adds a boolean "mustNot"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Ok, now the query requires that ALL of the words "all hands on deck" are present in matches. And we have set the defaultSearchProperty to "body", so the string query will now match terms in the searchable "body" property.</p>
</div>
<div class="paragraph">
<p>But we can do a little better. First let&#8217;s use an options Map instead of calling those setters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                                    // &lt;-- creates an implicit boolean query
    must(queryString("all hands on deck", [useAndDefaultOperator: true, defaultSearchProperty: "body"]))
        // ^^ add a "must" nested query string, calling useAndDefaultOperator() and setDefaultSearchProperty("body")
        //    on the CompassQueryStringBuilder
    lt("pages", 50)                         // &lt;-- uses CompassQueryBuilder#lt, and adds a boolean "should"
    must(term("type", "poetry"))            // &lt;-- uses CompassQueryBuilder#term, adds a boolean "must"
    mustNot(term("theme", "war"))           // &lt;-- uses CompassQueryBuilder#term, adds a boolean "mustNot"
}</pre>
</div>
</div>
<div class="paragraph">
<p>This is the same query as before, only fewer lines of code.</p>
</div>
<div class="paragraph">
<p>So now let&#8217;s use CompassQueryBuilder#multiPhrase instead of queryString, since a multi-phrase query can require that the words appear in order, whereas a query string generally just requires the words appear <em>somewhere</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                                    // &lt;-- creates an implicit boolean query
    must(multiPhrase("body", [slop: 2]) {   // &lt;-- creates a nested CompassMultiPhraseQueryBuilder context, calling setSlop(2)
        add("all")                          // &lt;-- calls CompassMultiPhraseQueryBuilder#add
        add("hands")                        // &lt;-- calls CompassMultiPhraseQueryBuilder#add
        add("on")
        add("deck")
    })                                      // &lt;-- adds multiPhrase as boolean "must"
    lt("pages", 50)                         // &lt;-- uses CompassQueryBuilder#lt, and adds a boolean "should"
    must(term("type", "poetry"))            // &lt;-- uses CompassQueryBuilder#term, adds a boolean "must"
    mustNot(term("theme", "war"))           // &lt;-- uses CompassQueryBuilder#term, adds a boolean "mustNot"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s go all out for the final example and add three new features: (i) move the number pages clause into a nested boolean with a new clause for items with <em>50 or more</em> pages, and a "boost" (meaning higher score/relevance) for the smaller number, (ii) a clause for "publishedDate" being within the last 4 weeks (and note the use of a <em>Date</em> object) and (iii) a sort first by relevance then author surname.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>search {                                    // &lt;-- creates an implicit boolean query
    must(multiPhrase("body", [slop: 2]) {   // &lt;-- creates a nested CompassMultiPhraseQueryBuilder context, and calls setSlop(2)
        add("all")                          // &lt;-- calls CompassMultiPhraseQueryBuilder#add
        add("hands")                        // &lt;-- calls CompassMultiPhraseQueryBuilder#add
        add("on")
        add("deck")
    })                                      // &lt;-- adds multiPhrase as boolean "must"
    must {                                  // &lt;-- creates an nested boolean query, implicitly
        ge("pages", 50)                     // &lt;-- uses CompassQueryBuilder#ge, adds a boolean "should"
        lt("pages", 50, [boost: 1.5])       // &lt;-- uses CompassQueryBuilder#lt, calls setBoost(1.5f), adds a boolean "should"
    }                                       // &lt;-- adds nested boolean as "must" clause to outer boolean
    must(term("type", "poetry"))            // &lt;-- uses CompassQueryBuilder#term, adds a boolean "must"
    mustNot(term("theme", "war"))           // &lt;-- uses CompassQueryBuilder#term, adds a boolean "mustNot"
    ge("publishedDate", new Date() - 28)
    sort(CompassQuery.SortImplicitType.SCORE)                  // &lt;-- uses CompassQuery#addSort
    sort("authorSurname", CompassQuery.SortPropertyType.STRING) // &lt;-- uses CompassQuery#addSort
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sorting">Sorting</h3>
<div class="paragraph">
<p>Search results are sorted by relevance by default, the most relevant being the first.</p>
</div>
<div class="paragraph">
<p>You can specify a custom sort when using either String queries or a query builder Closure using the <code>sort</code> and <code>order</code>/<code>direction</code> method options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>sort</code></strong> - Either <code>"SCORE"</code> (ie, relevance) or the name of a mapped class property</p>
</li>
<li>
<p><strong><code>order</code></strong> or <strong>direction</strong> - One of <code>"auto"</code>, <code>"reverse"</code>, <code>"asc"</code>, <code>"desc"</code>.</p>
</li>
</ul>
</div>
<h4 id="_examples" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Get Property instances matching "Riverside Apartment"
// sorted by price in ascending order
def searchResult = Property.search(
    "Riverside Apartment",
    sort: "price", order: "asc"
)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Find the least relevant for a fuzzy term search
def leastRelevant = searchableService.search({
        fuzzy("word", "roam")
    },
    result: "top", sort: "SCORE", direction: "reverse"
)</pre>
</div>
</div>
<div class="paragraph">
<p>The values <code>"auto"</code> and <code>"reverse"</code> are symbols for <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassQuery.SortDirection.html">Compass API constants</a>: when sorting by <code>SCORE</code> an order of <code>"auto"</code> means highest scoring first and <code>"reverse"</code> means lowest scoring first. When sorting by anything else, <code>"auto"</code> is the natural ascending order and <code>"reverse"</code> is the natural descending order.</p>
</div>
<div class="paragraph">
<p>The Searchable Plugin also gives you the opton to use <code>"asc"</code> or <code>"desc"</code> for the <code>order</code> or <code>direction</code> value.</p>
</div>
<div class="paragraph">
<p>Why are there two options for sort order - <code>order</code> and <code>direction</code> - and are they different? Well, they both control the sort order, and you can mix the option names and values, so they are actually just synonyms. But both are provided to satisfy those people more familiar with the GORM style parameters (<em>order</em> with <em>asc</em>/<em>desc</em>) and those more familiar with Compass and search engine queries (<em>direction</em> with <em>auto</em>/<em>reverse</em>). Choose whichever you prefer.</p>
</div>
<div class="paragraph">
<p>The following summaries the behaviour of these option combinations. Remember that <code>order</code> and <code>direction</code> are interchangable:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">sort</th>
<th class="tableblock halign-left valign-top">order <em>or</em> direction</th>
<th class="tableblock halign-left valign-top">Sorting behavoir</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SCORE"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"auto"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are ordered most-relevant (highest scoring) first. This is the default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SCORE"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"reverse"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are ordered least-relevant (lowest scoring) first.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SCORE"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"asc"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are ordered least-relevant (lowest scoring) first.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SCORE"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"desc"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are ordered most-relevant (highest scoring) first. This is the same as <code>SCORE</code> + <code>auto</code>, which is the default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"someProperty"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"asc"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are ordered in natural order for the <code>"someProperty"</code> field value, eg, String ascending, Number ascending</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"someProperty"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"desc"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are order in revserse natural order for the <code>"someProperty"</code> field value, eg, String descending, Number descending</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"someProperty"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"auto"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are ordered in natural order for the <code>"someProperty"</code> field value, eg, String ascending, Number ascending</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"someProperty"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"reverse"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The results are order in revserse natural order for the <code>"someProperty"</code> field value, eg, String descending, Number descending</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is also possible to add sorting using a <a href="index.html#_searching_query_builder">query builder Closure</a>, and in fact with that technique you can add multiple sorts, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.compass.core.*

// Sort first by score (relevance),
// then by most votes (when the score is equal)
def hits = searchableService.searchEvery {
    queryString("reality tv")
    sort(CompassQuery.SortImplicitType.SCORE)
    sort("votes", CompassQuery.SortDirection.REVERSE)
}</pre>
</div>
</div>
<div class="paragraph">
<p>When using a query building Closure you can also combine sorts in the closure with the above sort/order <em>options</em>.
If you do this, the sort/order <em>options</em> are added as the <em>last</em> sort in the chain and therefore are applied last.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mapping">Mapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A searchable class mapping describes how the class instance appears in the index and the data is searched.</p>
</div>
<div class="paragraph">
<p>This includes things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which properties are searchable</p>
</li>
<li>
<p>How a property is processed during indexing - whether it is "analyzed" or not, for example</p>
</li>
<li>
<p>How a property influences the search - whether it has a "boost", for example</p>
</li>
<li>
<p>How associated searchable classes are linked and/or embed one another&#8217;s searchable data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you declare</p>
</div>
<div class="listingblock">
<div class="content">
<pre>static searchable = true</pre>
</div>
</div>
<div class="paragraph">
<p>the plugin maps the class with
built-in <a href="index.html#_mapping_conventions">conventions</a>.</p>
</div>
<div class="paragraph">
<p>You can override these conventions in a number of ways:</p>
</div>
<h3 id="_the_mapping_dsl" class="discrete">The Mapping DSL</h3>
<div class="paragraph">
<p>The <a href="index.html#_mapping_dsl">mapping DSL</a>, is a bit like GORM&#8217;s mapping DSL.</p>
</div>
<div class="paragraph">
<p>You can selectively override the built-in <a href="index.html#_mapping_conventions">conventions</a> for specific properties (or the class itself),
and inherit the default behaviour for any properties you do no explicitly map.</p>
</div>
<h3 id="_native_compass_mappings" class="discrete">Native Compass Mappings</h3>
<div class="paragraph">
<p>You can also use <a href="index.html#_mapping_compass_annotations">Compass annotations</a> and
<a href="index.html#_mapping_compass_xml">Compass XML</a> to map your classes.</p>
</div>
<div class="paragraph">
<p>With either <a href="index.html#_mapping_compass_xml">Compass XML</a> or
<a href="index.html#_mapping_compass_annotations">Compass annotations</a>,
you need to map every aspect of the searchable class yourself. In other words,
the built-in <a href="index.html#_mapping_conventions">conventions</a> no longer apply to classes you map with Compass mappings.</p>
</div>
<div class="sect2">
<h3 id="_not_all_properties">Not All Properties</h3>
<h4 id="_using_only_and_except" class="discrete">Using only and except</h4>
<div class="paragraph">
<p>You can limit the properties that are made searchable like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    static searchable = [only: ['category', 'title']]
    // ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    static searchable = [except: 'createdAt']
    // ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>The value of except or only can be a String or List&lt;String&gt; as shown above.</p>
</div>
<div class="paragraph">
<p>The String can contain shell-like-wildcards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>*</strong> means any number of characters</p>
</li>
<li>
<p><strong>?</strong> means any single character</p>
</li>
</ul>
</div>
<h5 id="_except_and_only_wildcard_examples" class="discrete">except and only wildcard examples</h5>
<div class="listingblock">
<div class="content">
<pre>// map, eg, 'addressLine1', 'addressLine2', 'addressPostcode', etc...
static searchable = [only: 'address*']</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// do not map, eg, 'screenX' and 'screenY' and 'version'
static searchable = [except: ['screen?', 'version']]</pre>
</div>
</div>
<div class="paragraph">
<p>However read this [caveat and alternative approach|Searchable Plugin - Mapping - Not All Properties#Excluding certain fields from being searched].</p>
</div>
<h4 id="_using_except_or_only_with_class_property_mapping" class="discrete">Using except or only with class property mapping</h4>
<div class="paragraph">
<p>You can combine [class property mappings|Searchable Plugin - Mapping - Class Property Mapping] with only and except:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    static searchable = {
        except = ["version", "createdAt"]   // version and createdAt will not be mapped to the index
        category index: 'not_analyzed', excludeFromAll: true
        title boost: 2.0
        comments component: true
    }
    static hasMany = [comments: Comment]

    User author
    String title, post, category
    Date createdAt
}</pre>
</div>
</div>
<h4 id="_excluding_certain_fields_from_being_searched" class="discrete">Excluding certain fields from being searched</h4>
<div class="paragraph">
<p>Note that using only or except means that the index will only contain those properties as indicated, so when an object is returned from the index, some properties may be null, even if they have non-null values in the database.</p>
</div>
<div class="paragraph">
<p>You can do better than this by still mapping those properties to the index, but having them <em>not</em> actually indexed for search purposes. To do this add a [mapping for the property|Searchable Plugin - Mapping - Class Property Mapping] with an index: 'no' option.</p>
</div>
<div class="paragraph">
<p>This method may become default behavior for properties excluded from mapping with only and except in future.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mapping_conventions">Mapping conventions</h3>
<div class="paragraph">
<p>:WARNING First please familiarise yourself with some essential <a href="index.html#_mapping_compass_concepts">Compass mapping concepts</a>.</p>
</div>
<div class="paragraph">
<p>The easiest way to map a class to the search index is by declaring</p>
</div>
<div class="listingblock">
<div class="content">
<pre>static searchable = true</pre>
</div>
</div>
<div class="paragraph">
<p>which maps all "mappable" properties in the class using built-in rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simple property types* like numbers, dates and strings, or a collection of, are mapped as <strong>[searchable-properties|Searchable Plugin - Mapping - Compass concepts#Searchable Property]</strong>, which becomes the searchable text in the index.</p>
</li>
<li>
<p>Non-embedded domain class properties* or element type if a collection are mapped as <strong>[searchable-references|Searchable Plugin - Mapping - Compass concepts#Searchable Reference]</strong> as long as they are searchable too.</p>
</li>
<li>
<p>Embedded domain class properties* are mapped as <strong>[searchable-components|Searchable Plugin - Mapping - Compass concepts#Searchable Component]</strong> as long as they are not specifically non-searchable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>INFO: The <a href="index.html#_mapping_mapping_dsl">mapping DSL</a> gives you more flexibility.
For example you can limit the searchable properties and override the conventions a per-class-property basis, and define class-level mapping options.</p>
</div>
<h4 id="_example" class="discrete">Example</h4>
<div class="paragraph">
<p>Let&#8217;s take this class to explain the built-in mapping conventions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    static searchable = true
    static embedded = ['metadata']
    static hasMany = [comments: Comment]
    String category, title, post
    User author
    Metadata metadata
    Date createdAt
}</pre>
</div>
</div>
<h5 id="_simple_type_properties_become_the_searchable_text_in_the_index" class="discrete">Simple type properties become the searchable text in the index</h5>
<div class="paragraph">
<p>The simple type properties category, title, post and createdAt are mapped as <strong>[searchable-properties|Searchable Plugin - Mapping - Compass concepts#Searchable Property]</strong>.</p>
</div>
<div class="paragraph">
<p>As is the case with [searchable-properties|Searchable Plugin - Mapping - Compass concepts#Searchable Property], the values of these properties becomes searchable text in the index, in fields named after the property.</p>
</div>
<div class="paragraph">
<p>Additionally an "all" field is created which combines all searchable text for the object.</p>
</div>
<div class="paragraph">
<p>Therefore you can search for "title:grails" or "category:javascript" to target those specific fields, whereas if you search for just "grails" it will match any text in any searchable field.</p>
</div>
<h5 id="_non_embedded_domain_class_properties_become_searchable_references" class="discrete">Non-embedded domain class properties become searchable references</h5>
<div class="paragraph">
<p>As long as associated domain classes are searchable too, they are normally mapped as <strong>[searchable-references|Searchable Plugin - Mapping - Compass concepts#Searchable Reference]</strong>.</p>
</div>
<div class="paragraph">
<p>Here, if User and Comment are searchable, then the user and comments properties are both mapped as <strong>[searchable-references|Searchable Plugin - Mapping - Compass concepts#Searchable Reference]</strong>.</p>
</div>
<div class="paragraph">
<p>This means that when an object is returned from the index as a search hit, it can be returned along with it&#8217;s associated domain objects (and domain object collections) set on it.</p>
</div>
<h5 id="_embedded_domain_class_properties_become_searchable_components" class="discrete">Embedded domain class properties become searchable components</h5>
<div class="paragraph">
<p>The <strong>embedded</strong> domain class property  metadata  is mapped as a <strong>[searchable-component|Searchable Plugin - Mapping - Compass concepts#Searchable Component]</strong> so any search query that matches the  Post 's metadata will return that  Post  instance.</p>
</div>
<div class="paragraph">
<p>You have the choice of whether to declare the Metadata class as searchable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you don&#8217;t declare it as searchable, the class is automatically mapped as a [non-root|Searchable Plugin - Mapping - Class Mapping#Options] class with the built-in conventions</p>
</li>
<li>
<p>To make Metadata non-searchable you can add static searchable = false</p>
</li>
<li>
<p>Otherwise whatever value of Metadata&#8217;s static searchable property (or one of native the Compass mapping choices) defines how the class is mapped</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_compass_concepts">Compass concepts</h3>
<div class="paragraph">
<p>Properties of your domain classes will be mapped with one of the following strategies:</p>
</div>
<h4 id="_searchable_property" class="discrete">Searchable Property</h4>
<div class="paragraph">
<p>This is used for simple types (or collections of), basically anything that can be represented as a string in the index, eg, strings, numbers, dates, enums, etc.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We might use the phrase "searchable property" to refer to the class property that is mapped as a searchable property, as well as the mapping concept.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Within the index, a Lucene field named after the property is created, and the value of that field contains the searchable text. You can then target that field with a <em>prefixed</em> term in the query.</p>
</div>
<div class="paragraph">
<p>Additionally Compass creates a field in the index called <code>"all"</code> which contains all searchable text for a class instance. If you <em>do not</em> prefix search query terms, they hit the <code>"all"</code> field.</p>
</div>
<div class="paragraph">
<p>INFO: You can and probably should map your own immutable/value-types as searchable-properties.</p>
</div>
<div class="paragraph">
<p>INFO: You can provide a custom <code>Converter</code> implementation to convert the object to/from <code>String</code> form.</p>
</div>
<h5 id="_example_2" class="discrete">Example</h5>
<div class="paragraph">
<p>Given the following class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Book {
    String title, text
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>`title` and `text` can be mapped as a searchable-properties.</pre>
</div>
</div>
<div class="paragraph">
<p>You can then search specifically for text in <code>title</code> with a query string like <code>"title:attack"</code>.</p>
</div>
<div class="paragraph">
<p>The query string <code>"attack"</code> would match <code>Book</code> s with that word in their <code>title</code> or <code>text</code> fields (or both), because in
fact it hits the "all" field which combines all searchable text for the class instance.</p>
</div>
<h4 id="_searchable_reference" class="discrete">Searchable Reference</h4>
<div class="paragraph">
<p>This is used for complex types (or collections of); typically associated domain classes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We might use the phrase "searchable reference" to refer to the class property that is mapped as a searchable reference, as well as the mapping concept.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A searchable-reference&#8217;s class must be searchable itself.</p>
</div>
<div class="paragraph">
<p>When indexing an object its searchable-references are stored in their own indexes (Compass calls these "sub-indexes").</p>
</div>
<div class="paragraph">
<p>The relationship is also stored in the index belonging to the class with the searchable reference mapping. This is simply
the class type and id of the other object(s), so it&#8217;s efficient.</p>
</div>
<div class="paragraph">
<p>Therefore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Objects on either side of the relationship are first-class citizens in the index and can be search for in their own right.</p>
</li>
<li>
<p>When searching, hits will only occur for text present within the searchable class instance itself</p>
</li>
<li>
<p>When re-creating an object from the index (for search results), Compass can re-create its relationships too.</p>
</li>
</ul>
</div>
<h5 id="_example_3" class="discrete">Example</h5>
<div class="paragraph">
<p>Given the following two classes</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    Set&lt;Comment&gt; comments
    // ..
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>class Comment {
    Post post
    // ....
}</pre>
</div>
</div>
<div class="paragraph">
<p>lets says both classes are <em>searchable</em> and both <code>Post#comments</code> and <code>Comment#post</code> are mapped as <em>searchable-references</em> .</p>
</div>
<div class="paragraph">
<p>Now when a search matches a <code>Post</code> then the <code>Post</code> will be returned from the index with the <code>comments</code> populated from data
saved in the index - it doesn&#8217;t hit the database.</p>
</div>
<div class="paragraph">
<p>Likewise if a search finds a <code>Comment</code> it can be returned along with it&#8217;s associated <code>Post</code> .</p>
</div>
<h4 id="_searchable_component" class="discrete">Searchable Component</h4>
<div class="paragraph">
<p>This is used for complex types (or collections of); typically associated domain classes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We might use the phrase "searchable component" to refer to the class property that is mapped as a searchable component, as well as the mapping concept.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A searchable-component&#8217;s class must be searchable itself.</p>
</div>
<div class="paragraph">
<p>Unlike [searchable-references|Searchable Plugin - Mapping - Compass concepts#Searchable Reference], when indexing
searchable-components, those searchable-component objects are <strong>not</strong> stored in their own indexes (at least from the owning side).
Instead the data of the searchable-component is stored within the owning object&#8217;s own searchable data. In other words,
the searchable data of a searchable-component is <strong>added</strong> to the searchable data of the class instance declaring the property.</p>
</div>
<div class="paragraph">
<p>Therefore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can search for data that is embedded into a top-level object from a searchable component, this counts as a match for the top-level object</p>
</li>
<li>
<p>If the searchable component&#8217;s class is <em>not</em> mapped as a [root|Searchable Plugin - Mapping - Class Mapping#Options] class, then you will never find instances with search</p>
</li>
<li>
<p>When re-creating an object from the index (for search results), Compass can re-create its associated searchable-components too.</p>
</li>
</ul>
</div>
<h5 id="_example_4" class="discrete">Example</h5>
<div class="paragraph">
<p>Given the following two classes</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    Set&lt;Comment&gt; comments
    // ..
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>class Comment {
    Post post
    // ....
}</pre>
</div>
</div>
<div class="paragraph">
<p>lets says both classes are <em>searchable</em> and both <code>Post#comments</code> and <code>Comment#post</code> are mapped as <em>searchable-components</em> .</p>
</div>
<div class="paragraph">
<p>Now the user searches for a string that happens to match a <code>Comment</code> , they will get both <code>Post</code> and <code>Comment</code> hits.
Additionally search result objects will have their associations populated, and this doesn&#8217;t hit the database.</p>
</div>
<h4 id="_more_on_searchable_reference_and_searchable_component" class="discrete">More on Searchable Reference and Searchable  Component</h4>
<div class="paragraph">
<p>You cannot map the same class property as both a searchable reference <strong>and</strong> a searchable component.</p>
</div>
<div class="paragraph">
<p>However if you have a bidirectional relationship, it is possible to map one side of a relationship as a searchable-reference
and the other as searchable-component.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mapping_dsl">Mapping DSL</h3>
<div class="paragraph">
<p>The mapping DSL allows you customize various aspects of the class mapping, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Limit the searchable properties using <a href="index.html#_mapping_not_all_properties"><code>only</code> and <code>except</code></a></p>
</li>
<li>
<p>Change a property&#8217;s mapping by <a href="index.html#_mapping_class_property_mapping">explicitly declaring its mapping</a></p>
</li>
<li>
<p>Alter a class&#8217;s mapping by adding <a href="index.html#_mapping_class_mapping">class mapping options</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_class_property_mapping">Class Property Mapping</h3>
<div class="paragraph">
<p>If you want to override the [conventional mapping|Searchable Plugin - Mapping - Conventions] for one or more properties, make the value of <code>searchable</code> a <code>Closure</code> and add method calls named after the class property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Post {
    static searchable = {
        category index: 'not_analyzed', excludeFromAll: true
        title boost: 2.0
        comments component: true
    }
    static hasMany = [comments: Comment]
    User author
    String title, post, category
    Date createdAt
}</pre>
</div>
</div>
<div class="paragraph">
<p>The mapping options available depend on the kind of class property.</p>
</div>
<h4 id="_mapping_the_id" class="discrete">Mapping the id</h4>
<div class="paragraph">
<p>Compass needs to know the object&#8217;s identifier property, so that needs to be mapped too.</p>
</div>
<div class="paragraph">
<p>Since Grails has the well defined and generated <code>id</code> property, the plugin generates an id mapping.</p>
</div>
<div class="paragraph">
<p>You can customize this with an explicit [id mapping|Searchable Plugin - Mapping - Searchable Id].</p>
</div>
<h4 id="_mapping_simple_types" class="discrete">Mapping simple types</h4>
<div class="paragraph">
<p>For simple types, you can declare any of the [searchable property mapping options|Searchable Plugin - Mapping - Searchable Property].</p>
</div>
<h5 id="_example_5" class="discrete">Example</h5>
<div class="paragraph">
<p>Given the following class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Article {
    static searchable = true
    static hasMany = [keywords: String]
    String title, body
}</pre>
</div>
</div>
<div class="paragraph">
<p>we currently have a [conventional mapping|Searchable Plugin - Mapping - Conventions] because it declares simply <code>static searchable = true</code>. This maps both <code>title</code> and <code>body</code> as standard [searchable properties|Searchable Plugin - Mapping - Compass concepts#Searchable Property].</p>
</div>
<div class="paragraph">
<p>Let&#8217;s define a few additional [searchable property mapping options|Searchable Plugin - Mapping - Searchable Property] to customize the [conventional mapping|Searchable Plugin - Mapping - Conventions] to our needs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Article {
    static searchable = {
        title boost: 2.0
        keywords index: 'not_analyzed'
    }
    static hasMany = [keywords: String]
    String title, body
}</pre>
</div>
</div>
<div class="paragraph">
<p>In this case we&#8217;ve given <code>title</code> a <code>[boost|Searchable Plugin - Mapping - Searchable Property#Options]</code>, which means hits in the <code>title</code> property score higher than other properties, and we&#8217;ve declared <code>keywords</code> as <code>[not_analyzed|Searchable Plugin - Mapping - Searchable Property#Options]</code>, meaning it&#8217;s value is stored verbatim in the index.</p>
</div>
<h4 id="_mapping_associated_domain_classes" class="discrete">Mapping associated domain classes</h4>
<div class="paragraph">
<p>For associated domain classes you have two choices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can <strong>inherit and add</strong> to the [conventional mapping|Searchable Plugin - Mapping - Conventions] - whether a [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference] or [searchable component|Searchable Plugin - Mapping - Compass concepts#Searchable Component] - and add to it with the supported [searchable reference mapping options|Searchable Plugin - Mapping - Searchable Reference] or [searchable component mapping options|Searchable Plugin - Mapping - Searchable Component].</p>
</li>
<li>
<p>Or you can <strong>override</strong> the [conventional mapping|Searchable Plugin - Mapping - Conventions] - of [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference] or [searchable component|Searchable Plugin - Mapping - Compass concepts#Searchable Component] to be the other.</p>
</li>
</ul>
</div>
<h5 id="_example_6" class="discrete">Example</h5>
<div class="paragraph">
<p>Given the following classes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class News {
    static searchable = true
    static hasMany = [comments: Comment]
    String text
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>class Comment {
    static searchable = true
    String text
    News news
}</pre>
</div>
</div>
<div class="paragraph">
<p>We start out with the [conventional mapping|Searchable Plugin - Mapping - Conventions], since <code>Comment</code> and <code>News</code> declare <code>static searchable = true</code>.</p>
</div>
<div class="paragraph">
<p>This [maps the classes by convention|Searchable Plugin - Mapping - Conventions] meaning:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>News#comments</code> becomes a [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference]</p>
</li>
<li>
<p><code>Comment#news</code> becomes another [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference]</p>
</li>
</ul>
</div>
<h6 id="_inherit_and_add" class="discrete">Inherit and add</h6>
<div class="paragraph">
<p>To inherit the <code>Comment#news</code> [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference] mapping and add [searchable reference mapping options|Searchable Plugin - Mapping - Searchable Reference]:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Comment {
    static searchable = {
        news cascade: ['create', 'delete']
    }
    String text
    News news
}</pre>
</div>
</div>
<div class="paragraph">
<p>If you like you can also make the conventional mapping explicit, ie, declare it as a [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference] or [searchable component|Searchable Plugin - Mapping - Compass concepts#Searchable Component]:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Comment {
    static searchable = {
        news reference: [cascade: ['create', 'delete']]
    }
    String text
    News news
}</pre>
</div>
</div>
<div class="paragraph">
<p>The value of <code>reference</code> or <code>component</code> may be <code>true</code> or a <code>Map</code> of options.</p>
</div>
<h6 id="_override" class="discrete">Override</h6>
<div class="paragraph">
<p>To override the <code>News#comments</code> [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference] mapping and make it a [searchable component|Searchable Plugin - Mapping - Compass concepts#Searchable Component] instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class News {
    static searchable = {
        comments component: true
    }
    static hasMany = [comments: Comment]
    String text
}</pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify [searchable reference mapping options|Searchable Plugin - Mapping - Searchable Reference] or [searchable component mapping options|Searchable Plugin - Mapping - Searchable Component] options with a <code>Map</code> value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class News {
    static searchable = {
        comments component: [cascade: 'all', accessor: 'field']
    }
    static hasMany = [comments: Comment]
    String text
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_searchable_id">Searchable Id</h3>
<h4 id="_summary" class="discrete">Summary</h4>
<div class="paragraph">
<p>Used to map the searchable class&#8217;s identifier.</p>
</div>
<h4 id="_syntax" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    id options
}</pre>
</div>
</div>
<h4 id="_description" class="discrete">Description</h4>
<div class="paragraph">
<p>Maps the searchable id with the given [options|#Options].</p>
</div>
<h4 id="_parameters" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|#Options]</p>
</li>
</ul>
</div>
<h5 id="_options" class="discrete">Options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>name</code></strong> - The name of the searchable id field in the index. Default is <code>id</code>. This allows you to target the id field in a query, eg, if you decided to name your id <code>"_\_the\_id\__"@ you could query it with @"\__the\_id\_\_:10"</code>.</p>
</li>
<li>
<p><strong><code>accessor</code></strong> - How the property is accessed. One of <code>"field"</code> or <code>"property"</code>. Default is <code>"property"</code></p>
</li>
<li>
<p><strong><code>converter</code></strong> - The name of a configured converter to use to convert the property value to/from text</p>
</li>
</ul>
</div>
<h4 id="_examples_2" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Obscure the name of the id property
id name: "\_\_the\_id\_\_"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_searchable_property_2">Searchable Property</h3>
<h4 id="_summary_2" class="discrete">Summary</h4>
<div class="paragraph">
<p>Used to map [searchable properties|Searchable Plugin - Mapping - Compass concepts#Searchable Property].</p>
</div>
<h4 id="_syntax_2" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    propertyName options
}</pre>
</div>
</div>
<h4 id="_description_2" class="discrete">Description</h4>
<div class="paragraph">
<p>Maps the class&#8217;s <code>propertyName</code> property with the given [options|#Options].</p>
</div>
<div class="paragraph">
<p>Supports regular properties (those you declare the field for) and synthetic properties (those with no class field but a "getter" method).</p>
</div>
<div class="paragraph">
<p>It is possible to map the same property with multiple different mappings (as long as the mappings are semantically valid), see the [examples|#Examples].</p>
</div>
<h4 id="_parameters_2" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>options</code></strong> - a <code>Map</code> of [options|#Options]</p>
</li>
</ul>
</div>
<h5 id="_options_2" class="discrete">Options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>accessor</code></strong> - How the property is accessed. One of <code>"field"</code> or <code>"property"</code>. Default is <code>"property"</code></p>
</li>
<li>
<p><strong><code>analyzer</code></strong> - The name of a configured analyzer used to analyze this property. Default is <code>"default"</code> which is a built-in analyzer (Lucene&#8217;s StandardAnalyzer)</p>
</li>
<li>
<p><strong><code>boost</code></strong> - A decimal boost value. With a positive value, promotes search results for hits in this property; with a negative value, demotes search results that hit this property. Default is @1.0@</p>
</li>
<li>
<p><strong><code>excludeFromAll</code></strong> - Whether the property should be excluded from the generated <code>"all"</code> searchable text field in the index. One of <code>"yes"</code>, <code>"no"</code> or <code>"no_analyzed"</code></p>
</li>
<li>
<p><strong><code>format</code></strong> - How the property is formatted when made into searchable text. Applies to objects like `Date`s and `Number`s usually for the purposes of range searches. Value is a format string for the appropriate formatter.</p>
</li>
<li>
<p><strong><code>index</code></strong> - How or if the property is made into searchable text. One of <code>"'no"</code>, <code>"not_analyzed"</code> or <code>"analyzed"</code>.</p>
</li>
<li>
<p><strong><code>name</code></strong> - The name of the field in the search index. Can be used with multiple mappings for the same property, each with their own name. Default is <code>propertyName</code>. This becomes the name of the field in the index, so if @name@ is @"title"@, you can target that field with a query like @"title:grails"@</p>
</li>
<li>
<p><strong><code>nullValue</code></strong> - The value to use if the property is <code>null</code> when indexed.</p>
</li>
<li>
<p><strong><code>propertyConverter</code></strong> - The name of a configured <code>ResourcePropertyConverter</code> which converts the property from/to searchable text.</p>
</li>
<li>
<p><strong><code>reverse</code></strong> - Whether the property should be reversed when made searchable. One of <code>"no"</code>, <code>"reader"</code> or <code>"string`". Default is `"no"</code></p>
</li>
<li>
<p><strong><code>spellCheck</code></strong> - Should the values of the property be included in the spell-check index? Either <code>"include"</code> or `"exclude"@. If not defined then inherits the class&#8217;s own spell-check mapping.</p>
</li>
<li>
<p><strong><code>store</code></strong> - Should the value be stored in the index? One of <code>"yes"</code>, <code>"no"</code> or <code>"compress"</code>. If <code>"no"</code> then the property may still be searchable (depending on the @index@ option), but when re-creating the object for search results this property will always be null. <code>"compress"</code> is useful for large or binary property values. Default is @"yes"@</p>
</li>
<li>
<p><strong><code>termVector</code></strong> - Should the term-vector data be collected for the property in the index? One of <code>"yes"</code>, <code>"no"</code>, `"with\_positions`", `"with\_offsets`", `"with\_positions\_offsets`". If not defined inherits the class&#8217;s term-vector mapping. This is required for [more-like-this|Searchable Plugin - Methods - moreLikeThis] searches.</p>
</li>
</ul>
</div>
<h4 id="_examples_3" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Give matches in the title field a boost
title boost: 2.0</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Format a date property
// so it's easy to search with range queries
createdAt format: "yyyyMMdd"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Format a number property padding with zeroes
// so it's easy to search with range queries
numVotes format: "0000"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Multiple mappings for the same class property, one analyzed the other not
// This means we can search for, say, "tagsExact:Miami" and it would only match the
// exact text "Miami", not "MiAmi" or "miami" etc.
// And we can search for "tags:Miami" and match any variation
tags index: 'not\_analyzed', name: 'tagsExact'
tags index: 'analyzed'</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_searchable_reference_2">Searchable Reference</h3>
<h4 id="_summary_3" class="discrete">Summary</h4>
<div class="paragraph">
<p>Used to map [searchable references|Searchable Plugin - Mapping - Compass concepts#Searchable Reference].</p>
</div>
<h4 id="_syntax_3" class="discrete">Syntax</h4>
<div class="paragraph">
<p>{code}
static searchable = {
    propertyName options
}
{code}</p>
</div>
<div class="paragraph">
<p>{code}
static searchable = {
    propertyName reference: true
}
{code}</p>
</div>
<div class="paragraph">
<p>{code}
static searchable = {
    propertyName reference: options
}
{code}</p>
</div>
<h4 id="_description_3" class="discrete">Description</h4>
<div class="paragraph">
<p>Maps the class&#8217;s <code>propertyName</code> property with the given [options|#Options].</p>
</div>
<div class="paragraph">
<p>You can use all three syntaxes when a [conventional mapping|Searchable Plugin - Mapping - Conventions] would give you a [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference].</p>
</div>
<div class="paragraph">
<p>When you want to change a [conventional searchable component mapping|Searchable Plugin - Mapping - Conventions] (which can happen when the associated class is embedded), you can use either of the last two syntaxes to make it a [searchable reference|Searchable Plugin - Mapping - Compass concepts#Searchable Reference] instead.</p>
</div>
<h4 id="_parameters_3" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>options</code></strong> - a <code>Map</code> of [options|#Options]</p>
</li>
</ul>
</div>
<h5 id="_options_3" class="discrete">Options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>accessor</code></strong> - How the property is accessed. One of <code>"field"</code> or <code>"property"</code>. Default is <code>"property"</code></p>
</li>
<li>
<p><strong><code>cascade</code></strong> - The operations to cascade to the target association. A <code>String</code> comma-delimited-list of values in <code>"all"</code>, <code>"create"</code>, <code>"save"</code> and <code>"delete"</code>.</p>
</li>
<li>
<p><strong><code>converter</code></strong> - The name of a configured converter to use to convert the property value to/from text</p>
</li>
<li>
<p><strong><code>lazy</code></strong> - If <code>true</code> the association is lazy when recreating the owing instance for search results. Only applicable to Collections or arrays. Default is <code>false</code></p>
</li>
</ul>
</div>
<h4 id="_examples_4" class="discrete">Examples</h4>
<div class="paragraph">
<p>{code}
metadata converter: "metadata\_converter"
{code}</p>
</div>
<div class="paragraph">
<p>{code}
metadata reference: true
{code}</p>
</div>
<div class="paragraph">
<p>{code}
metadata reference: [converter: "metadata\_converter"]
{code}</p>
</div>
</div>
<div class="sect2">
<h3 id="_searchable_component_2">Searchable Component</h3>
<h4 id="_summary_4" class="discrete">Summary</h4>
<div class="paragraph">
<p>Used to map [searchable components|Searchable Plugin - Mapping - Compass concepts#Searchable Component].</p>
</div>
<h4 id="_syntax_4" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    propertyName options
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    propertyName component: true
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    propertyName component: options
}</pre>
</div>
</div>
<h4 id="_description_4" class="discrete">Description</h4>
<div class="paragraph">
<p>Maps the class&#8217;s <code>propertyName</code> property with the given [options|#Options].</p>
</div>
<div class="paragraph">
<p>You can use all three syntaxes when a [conventional mapping|Searchable Plugin - Mapping - Conventions] would give you a [searchable component|Searchable Plugin - Mapping - Compass concepts#Searchable Component].</p>
</div>
<div class="paragraph">
<p>When you want to change a [conventional searchable reference mapping|Searchable Plugin - Mapping - Conventions] (which is the normally how domain class associations are mapped), you can use either of the last two syntaxes to make it a [searchable component|Searchable Plugin - Mapping - Compass concepts#Searchable Component] instead.</p>
</div>
<h4 id="_parameters_4" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>options</code></strong> - a <code>Map</code> of [options|#Options]</p>
</li>
</ul>
</div>
<h5 id="_options_4" class="discrete">Options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>accessor</code></strong> - How the property is accessed. One of <code>"field"</code> or <code>"property"</code>. Default is <code>"property"</code></p>
</li>
<li>
<p><strong><code>cascade</code></strong> - The operations to cascade to the target association. A <code>String</code> comma-delimited-list of values in <code>"all"</code>, <code>"create"</code>, <code>"save"</code> and <code>"delete"</code>.</p>
</li>
<li>
<p><strong><code>converter</code></strong> - The name of a configured converter to use to convert the property value to/from text</p>
</li>
<li>
<p><strong><code>maxDepth</code></strong> - The depth of cyclic component references allowed. Default is <code>1</code></p>
</li>
<li>
<p><strong><code>prefix</code></strong> - A <code>String</code> prefix to apply to the component&#8217;s properties. A prefix can be used to distinguish between multiple components of the same type. Without a prefix you can search within a component&#8217;s properties with their property names, eg, <code>"city:london"</code>, with a prefix like <code>'homeAddress$'</code> you can search for <code>'homeAddress$city:london'</code></p>
</li>
</ul>
</div>
<h4 id="_examples_5" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Provide a custom converter
metadata converter: "metadata\_converter"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Map metadata as a component, overriding any conventional mapping
metadata component: true</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Map metadata as a component, overriding any conventional mapping
// and define some options
metadata component: [converter: "metadata\_converter"]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_mapping">Class Mapping</h3>
<h4 id="_summary_5" class="discrete">Summary</h4>
<div class="paragraph">
<p>Defines the class mapping</p>
</div>
<h4 id="_syntax_5" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    option value
    option value
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    mapping options
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    mapping {
        option value
        option value
    }
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>static searchable = {
    mapping options, {
        option value
        option value
    }
}</pre>
</div>
</div>
<h4 id="_description_5" class="discrete">Description</h4>
<div class="paragraph">
<p>A number of mapping options affect the class itself or provide defaults for property mappings.</p>
</div>
<div class="paragraph">
<p>The syntaxes are interchangeable. Use whichever you prefer.</p>
</div>
<div class="paragraph">
<p>One of the last three syntaxes (introduced by the <strong><code>mapping</code></strong> keyword) may be necessary if you need to use an option that clashes with one of your domain class property names.</p>
</div>
<h4 id="_parameters_5" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|#Options]</p>
</li>
<li>
<p><strong><code>option</code></strong> - The name of an [option|#Options]</p>
</li>
<li>
<p><strong><code>value</code></strong> - An [option|#Options] value</p>
</li>
</ul>
</div>
<h5 id="_options_5" class="discrete">Options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>all</code></strong> - Controls the behaviour of the automatically created "all" field in the index for instances of this class. If not defined uses built-in defaults. <a href="index.html#_mapping">More</a></p>
</li>
<li>
<p><strong><code>analyzer</code></strong> - The name of a configured Analyzer used to analyze the searchable data of instances. Overridable on a per property basis. Default is <code>"default"</code>, a built-in Analyzer.</p>
</li>
<li>
<p><strong><code>alias</code></strong> - A name for documents of this class type in the index. Default is the simple class name, eg, the class <code>org.boom.User</code> would have an alias of <code>"User"</code> by default. It&#8217;s essentially a piece of constant text added for every object of this class type, and allows you to query by class, eg, <code>"alias:User maurice"</code></p>
</li>
<li>
<p><strong><code>boost</code></strong> - A decimal value which increases or decreases the ranking of hits for this class if positive or negative respectively. Default is <code>1.0</code></p>
</li>
<li>
<p><strong><code>constant</code></strong> - Allows you to define constant searchable data for every instance of the class. Requires a <code>Map</code> value, which defines the <code>constant&#8217;s `name</code> and <code>value</code> or <code>values</code> and other options. [More|Searchable Plugin - Mapping - constant]</p>
</li>
<li>
<p><strong><code>converter</code></strong> - The name of configured Converter used to convert this class to/from searchable text. A Compass default is used if not defined.</p>
</li>
<li>
<p><strong><code>root</code></strong> - Defines whether class instances are kept in their own index. When <code>false</code> instances should be <a href="index.html#_mapping_compass_concepts">searchable components</a> of another class, otherwise they are not saved in any index and cannot be searched for. Default is <code>true</code>.</p>
</li>
<li>
<p><strong><code>spellCheck</code></strong> - Whether to include the instance searchable data is added to the spell check index. Either "`include"` or <code>"exclude"</code> to include or exclude from the spell-check index respectively. Default is <code>"exclude"</code>.</p>
</li>
<li>
<p><strong><code>subIndex</code></strong> - The name of the Lucene index for this class. By default, each searchable class (or hierarchy) gets its own complete Lucene index, with the same name as <code>alias</code>. (Compass calls these "sub-indexes".) This name is then used as the index&#8217;s on-disk directory name or as the table-table name, for example, depending on your index storage strategy. This option allows you to override the default behaviour. For example you could use the same sub-index for multiple different classes.</p>
</li>
<li>
<p><strong><code>supportUnmarshall</code></strong> - Whether you need to get the data in the index back out again as domain classes. If <code>false</code> class instances are "marshalled" to the index, but they cannot be "unmarshalled" back into classes (ie the reverse). May be useful if you want to easily index your data but are accessing the index directly with Compass/Lucene yourself. Default is <code>true</code>.</p>
</li>
</ul>
</div>
<h4 id="_examples_6" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Define class mapping options the simple way
static searchable = {
    alias "foobar"
    subIndex "fb"
    constant name: "type", value: "some foobar"
    constant name: "noise", values: ["squawk", "shriek"]
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Define class mapping options with the "mapping" keyword;
// some options are defined within a Map option to "mapping"
// and others are given in a nested Closure
static searchable = {
    mapping alias: "foobar", subIndex: "fb", {
        constant name: "type", value: "some foobar"
        constant name: "noise", values: ["squawk", "shriek"]
    }
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Define class mapping options within the nested "mapping" Closure
static searchable = {
    mapping {
        boost 2.0
        spellCheck "include"
    }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compass_annotations">Compass annotations</h3>
<div class="paragraph">
<p>In order to use Compass annotations just define them in your classes, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.compass.annotations.*

@Searchable(alias = 'user')
class User {
    static hasMany = [friends: User]

    @SearchableId
    Long id

    @SearchableProperty
    String name

    @SearchableReference(refAlias = 'user')
    Set friends
}</pre>
</div>
</div>
<div class="paragraph">
<p>Normally with Compass you need a master XML config file - typically  <code>compass.cfg.xml</code>  - in which you declare these mapped classes. With the Searchable Plugin you can choose whether you want a  <code>compass.cfg.xml</code>; if it is not found, it detects annotated domain classes  automatically.</p>
</div>
<div class="paragraph">
<p>Note that when using annotations, Compass (well, Java really) needs actual properties for the annotations to annotate, so you might find you have to add things like the  <code>id</code>  property of the class and any <code>Collection</code>  properties that are normally created dynamically by Grails.</p>
</div>
<div class="paragraph">
<p>Additionally, relationships in Grails are lazy by default, meaning that direct property access does not always work as you might expect (you might be accessing the property of a lazy proxy rather than the associated domain class) and getter/setter methods should be used instead. You may find you need to need to add an <code>accessor = 'property'</code> to your annotations like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@SearchableId(accessor = 'property')
Long id</pre>
</div>
</div>
<div class="paragraph">
<p>which tells Compass to use getter/setter access rather than field access. Or you can just annotate the getter instead of the field.</p>
</div>
<div class="paragraph">
<p>Refer to the Compass docs [from here|http://www.compass-project.org] for more.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in index.adoc - include::Managing the index.adoc[]</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default the plugin configures the search engine for you.</p>
</div>
<div class="paragraph">
<p>If you want to override any of these settings, or simply prefer the settings declared in your own codebase rather than within the plugin&#8217;s, install the configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails install-searchable-config</pre>
</div>
</div>
<div class="paragraph">
<p>from your project dir, then edit the generated file, <strong><code>myproject/grails-app/conf/Searchable.groovy</code></strong>.</p>
</div>
<div class="paragraph">
<p>It uses the same tech as <code>Config.grooy</code> so it supports per-environment config.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The name and syntax of this file has chaged in 0.5; it was previously called <strong><code>SearchableConfiguration.groovy</code></strong>.
You can migrate your settings by just installing the newer config file and copy/pasting across.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With this file you can configure such things as</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The index location (eg, file-system or RAM index)</p>
</li>
<li>
<p>Default search options (max, escape, reload, etc)</p>
</li>
<li>
<p>Default property mapping exclusions and formats</p>
</li>
<li>
<p>Enabling/disabling the bulk index and mirror changes features</p>
</li>
<li>
<p>Compass settings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the docs in the [config file itself|https://svn.codehaus.org/grails-plugins/grails-searchable/trunk/src/conf/Searchable.groovy] for more.</p>
</div>
<h3 id="_spring_beans" class="discrete">Spring beans</h3>
<div class="paragraph">
<p>Since 0.5.1, custom <a href="index.html#_analyzers">analyzers</a> and <a href="index.html#_converters">converters</a> can be defined as Spring beans.</p>
</div>
<h3 id="_native_compass_xml_config" class="discrete">Native Compass XML config</h3>
<div class="paragraph">
<p>Since 0.4 the plugin also looks for a native Compass XML configuration file at the root of the classpath called <strong><code>compass.cfg.xml</code></strong>. If this file is present, Compass is configured with the settings defined in it, in addition to any that may be defined by the plugin&#8217;s own <strong><code>Searchable.groovy</code></strong>.</p>
</div>
<div class="paragraph">
<p>See the [XML configuration section|http://www.opensymphony.com/compass/versions/1.1/html/core-configuration.html#core-configuration-xml] of the Compass manual for more info and examples.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analyzers">Analyzers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to make your data searchable it is typically <em>analyzed</em>.</p>
</div>
<div class="paragraph">
<p>When text is analyzed using Lucene&#8217;s <code>StandardAnalyzer</code>, for example,
white-space and other irrelevant characters (eg punctation) are
discarded, as are un-interesting words (eg, 'and', 'or', etc) and the
remaining words are lower-cased. The input text is effectively
normalized for the search index.</p>
</div>
<div class="paragraph">
<p>Additionally when you search with a query string, that too is
analyzed. This process means that the terms you search on are
normalized in the same way as the terms in the index.</p>
</div>
<div class="paragraph">
<p>Lucene includes many analyzers out of the box and you can also provide
your own.</p>
</div>
<h3 id="_what_we_get_with_compass" class="discrete">What we get with Compass</h3>
<div class="paragraph">
<p>Compass acts as a registry of Analyzers, each identified by a name.</p>
</div>
<div class="paragraph">
<p>Compass provides two analyzers: <code>"default"</code> which is used for indexing
and <code>"search"</code> which is used for searching (analyzing query strings).</p>
</div>
<div class="paragraph">
<p>They are both instances of Lucene&#8217;s <code>StandardAnalyzer</code> (or equivalent).</p>
</div>
<div class="paragraph">
<p>You can re-define both of these or define additional analyzers with
new names.</p>
</div>
<h3 id="_defining_analyzer_implementations" class="discrete">Defining Analyzer implementations</h3>
<div class="paragraph">
<p>You can define an analyzer with [#Compass settings] and (since 0.5.1) as
a [#Spring bean].</p>
</div>
<h4 id="_compass_settings" class="discrete">Compass settings</h4>
<div class="paragraph">
<p>The "Compass settings":http://www.compass-project.org/docs/2.1.0/reference/html/core-settings.html#core-configuration-searchengineanalyzers
can either be defined in the plugin&#8217;s <a href="index.html#_configuration">configuration</a> or in a <a href="index.html#_configuration">native Compass configuration file</a>.</p>
</div>
<div class="paragraph">
<p>Compass actually provides shortcut names for some of the standard Lucene analyzers, and this is a simple way to define them, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Map compassSettings = [
    'compass.engine.analyzer.german.type': 'German'
]</pre>
</div>
</div>
<div class="paragraph">
<p>Here <code>"German"</code> is a synonym provided by Compass for one of the standard Lucene analyzers and it has been named "german".</p>
</div>
<div class="paragraph">
<p>But you can also define your own implementations this way with a fully qualified class name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Map compassSettings = [
    'compass.engine.analyzer.swedishChef.type': 'com.acme.lucene.analysis.SwedishChefAnalyzer'
]</pre>
</div>
</div>
<div class="paragraph">
<p>See the "Compass settings reference":http://www.compass-project.org/docs/2.1.0/reference/html/core-settings.html#core-configuration-searchengineanalyzers and "general discussion with XML examples":http://www.compass-project.org/docs/2.1.0/reference/html/core-searchengine.html#core-searchengine-analyzers for the complete range of options.</p>
</div>
<h4 id="_spring_bean" class="discrete">Spring bean</h4>
<div class="paragraph">
<p><em>Since 0.5.1</em></p>
</div>
<div class="paragraph">
<p>If you define a Spring bean in <code>resources.xml</code> or <code>resources.groovy</code>
that is an instance of <code>org.apache.lucene.analysis.Analyzer</code> then it wil be
automatically registered with Compass using the Spring bean name as it&#8217;s name.</p>
</div>
<div class="paragraph">
<p>This allows you to inject your analyzer with other Spring beans and
configuration, eg</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import com.acme.lucene.analysis.MyHtmlAnalyzer

beans = {
    htmlAnalyzer(MyHtmlAnalyzer) {
        context = someContext
        includeMeta = true
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>defines an analyzer called <code>"htmlAnalyzer"</code>, while</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.apache.lucene.analysis.standard.StandardAnalyzer

beans = {
    'default'(StandardAnalyzer, new HashSet()) // there are now no stop words
}</pre>
</div>
</div>
<div class="paragraph">
<p>re-defines the <code>"default"</code> analyzer so that it has no stop-words (and
will not discard 'and', 'or', etc).</p>
</div>
<h3 id="_using_analyzers" class="discrete">Using Analyzers</h3>
<h4 id="_indexing" class="discrete">Indexing</h4>
<div class="paragraph">
<p>For indexing purposes you define the analyzer in the mapping, either at the class level</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Book {
    static searchable = {
        analyzer 'bookAnalyzer'
    }
    String title
}</pre>
</div>
</div>
<div class="paragraph">
<p>and/or at the property level</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Book {
    static searchable = {
        title analyzer: 'bookTitleAnalyzer'
    }
    String title
}</pre>
</div>
</div>
<div class="paragraph">
<p>Property-level analyzers override class-level analyzers just for that property.</p>
</div>
<div class="paragraph">
<p>Note you can also use native Compass <a href="index.html#_mapping_compass_xml">XML</a>
or <a href="index.html#_mapping_compass_annotations">annotations</a> to map with custom analyzers.</p>
</div>
<h4 id="_searching_2" class="discrete">Searching</h4>
<div class="paragraph">
<p>You can say which analyzer you want to use on a per-query basis</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def sr = Song.search("only the lonely", analyzer: 'songLyricsAnalyzer')</pre>
</div>
</div>
<div class="paragraph">
<p>or with the <a href="index.html#_configuration">plugin&#8217;s configuration</a>
you can choose a search analyzer for all search queries (unless
overriden on a per-query basis).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    defaultMethodOptions = [
        search: [reload: false, escape: false, offset: 0, max: 10, defaultOperator: "and", analyzer: 'myAnalyzer'],
        suggestQuery: [userFriendly: true]
    ]</pre>
</div>
</div>
<div class="paragraph">
<p>You could also simply redefine the <code>"search"</code> analyzer to achieve the
same effect.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_converters">Converters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to transform your objects and their properties into
searchable text, and from data stored in the index back into objects,
Compass has the notion of <em>converters</em>.</p>
</div>
<div class="paragraph">
<p>Compass acts as a registry of converters, each identified by name.</p>
</div>
<div class="paragraph">
<p>Compass includes many converters itself, some responsible for
converting entire class instances and some for individual properties.</p>
</div>
<div class="paragraph">
<p>Additionally the plugin includes a custom converter itself which
supports <code>Map&lt;String, String&gt;</code> class property types, since Grails
supports this as a persistent class property type.</p>
</div>
<h3 id="_defining_converter_implementations" class="discrete">Defining Converter implementations</h3>
<div class="paragraph">
<p>You can define a converter with Compass settings and (since 0.5.1) as
Spring beans.</p>
</div>
<h4 id="_compass_settings_2" class="discrete">Compass settings</h4>
<div class="paragraph">
<p>The "Compass settings":http://www.compass-project.org/docs/2.1.0/reference/html/core-settings.html#config-converter
can either be defined in the plugin&#8217;s <a href="index.html#_configuration">configuration</a> or in a <a href="index.html#_configuration">native Compass configuration file</a>.</p>
</div>
<div class="paragraph">
<p>In the plugin&#8217;s config you might do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Map compassSettings = [
    'compass.converter.funkyConverter.type': 'com.acme.my.converters.MyFunkyConverter',
    'compass.converter.funkyConverter.registerClass': 'com.acme.my.special.classes.MyCoolDateTime'
]</pre>
</div>
</div>
<div class="paragraph">
<p>which registers the class MyFunkyConverter as a converter with the name "funkyConverter" which can be configured to be used on properties of type MyCoolDateTime in a domain class.</p>
</div>
<div class="paragraph">
<p>See the "Compass settings":http://www.compass-project.org/docs/2.1.0/reference/html/core-settings.html#config-converter for the complete range of options.</p>
</div>
<h4 id="_spring_beans_2" class="discrete">Spring beans</h4>
<div class="paragraph">
<p>If you define a Spring bean in <code>resources.xml</code> or <code>resources.groovy</code>
that is an instance of <code>org.compass.core.converter.Converter</code> then it wil be
automatically registered with Compass using the Spring bean name as it&#8217;s name.</p>
</div>
<div class="paragraph">
<p>This allows you to inject your analyzer with other Spring beans and
configuration, eg</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import com.acme.compass.converter.MyHtmlConverter
beans = {
    htmlConverter(MyHtmlConverter) {
        context = someContext
        includeMeta = true
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>defines a converter called <code>"htmlConverter"</code>.</p>
</div>
<h3 id="_using_converters" class="discrete">Using Converters</h3>
<div class="paragraph">
<p>Converters are defined in the class mapping, at either the class level</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Book {
    static searchable = {
        converter 'bookConverter'
    }
    String title
}</pre>
</div>
</div>
<div class="paragraph">
<p>and/or at the property level</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Book {
    static searchable = {
        title converter: 'bookTitleConverter'
    }
    String title
}</pre>
</div>
</div>
<div class="paragraph">
<p>Note you can also use native Compass <a href="index.html#_mapping_compass_xml">XML</a> or <a href="index.html#_mapping_compass_annotations">annotations</a> to map with custom converters.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debugging">Debugging</h2>
<div class="sectionbody">
<h3 id="_logging" class="discrete">Logging</h3>
<div class="paragraph">
<p>Enable Searchable Plugin debug logging by adding the following to Config.groovy&#8217;s log4j section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// log4j configuration
log4j = {
    ....

    debug 'org.codehaus.groovy.grails.plugins.searchable'

    // more detailed debug logging
    // trace 'org.compass'
}</pre>
</div>
</div>
<h3 id="_luke_for_inspecting_the_index" class="discrete">Luke - for inspecting the index</h3>
<div class="paragraph">
<p>[Luke|http://code.google.com/p/luke/] is a Swing GUI for Lucene indexes.</p>
</div>
<div class="paragraph">
<p>Use Luke to inspect the index and test queries.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_faq">FAQ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>{info:title=Contribute!}</p>
</div>
<div class="paragraph">
<p>This FAQ is a work in progress!</p>
</div>
<div class="paragraph">
<p>Please add stuff that you think others may find helpful.
{info}</p>
</div>
<h3 id="_negative_numbers_are_indexed_as_positive" class="discrete">Negative numbers are indexed as positive</h3>
<div class="paragraph">
<p>This is probably because the number is being "analyzed" during the index process.</p>
</div>
<div class="paragraph">
<p>This process is usually applied to searchable text to normalize it and remove what are normally useless words and characters (punctuation for example).</p>
</div>
<div class="paragraph">
<p>If you want to store the value of any searchable property <em>exactly</em> as it appears map that field with <code>index: "not_analyzed"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Idea {
    static searchable = {
        votes index: "not_analyzed"
    }
    int votes
    // ...
}</pre>
</div>
</div>
<h3 id="_number_range_searches_don_t_return_the_expected_results" class="discrete">Number Range searches don&#8217;t return the expected results</h3>
<div class="paragraph">
<p>Searching for objects with values for a numeric property in a certain range may return unexpected results.</p>
</div>
<div class="paragraph">
<p>Say you have the following domain class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Bug {
    static searchable = {
        votes index: "not_analyzed"
    }
    int votes = 0
    // ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>And you want to search for Bugs with between 0 and 20 votes. With the Searchable plugin you could do it this way</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def results = Bug.search("votes:[0 TO 20]")</pre>
</div>
</div>
<div class="paragraph">
<p>But you might get back bugs with votes with 100 votes! What gives?</p>
</div>
<div class="paragraph">
<p>Data in the search index is not typed like a database, everything is text. So comparisons are done lexicographically, rather than numerically as you would expect in this case.</p>
</div>
<div class="paragraph">
<p>The solution is to apply some formatting that pads the number with zeros. The "format" mapping option defines how the number is converted to searchable text in the index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Bug {
    static searchable = {
        votes index: "not_analyzed", format: "000000000"
    }
    int votes = 0
    // ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>With this mapping the search above works as you would expect.</p>
</div>
<div class="paragraph">
<p>Note: search indexes are like databases in some respects and you need to think about the storage of every piece of data in there. Giving something too much room may result in a larger than necessary search index (on disk). Compare the search index mapping to the database column to fine the right amount of padding for number formats.</p>
</div>
<h3 id="_startup_is_slow" class="discrete">Startup is slow</h3>
<div class="paragraph">
<p>The plugin performs a synchronous bulk-index of all the searchable domain class instances in your app by default.</p>
</div>
<div class="paragraph">
<p>You have a few options:</p>
</div>
<h4 id="_bulk_index_at_startup" class="discrete">Bulk index at startup</h4>
<div class="paragraph">
<p>You can change the default <strong>bulk-index-on-startup</strong> setting with <a href="index.html#_configuration">configuration</a>: you can disable it or fork a new thread.</p>
</div>
<div class="paragraph">
<p>Even if you disable it, you can always call <code>searchableService.index()</code> to perform a complete index at any time</p>
</div>
<div class="paragraph">
<p>You can also perform a bulk-index in a separate thread easily like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Thread.start {
    println "forked bulk index thread"
    searchableService.index()
    println "bulk index thread finished"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Which is a good thing since whilst performing a bulk-index Compass does not actually destroy the current index until the bulk-index is finished, so if you have a previous index you can do searches even while the index is being refreshed.</p>
</div>
<h4 id="_disable_mirroring_during_bootstrap" class="discrete">Disable mirroring during bootstrap</h4>
<div class="paragraph">
<p>If mirroring is enabled (default is on) and you are creating domain classes in your <code>BootStrap#init</code> you can temporarily disable mirroring while the bootstrap process runs then enable it and perform a complete index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class BootStrap {
    def searchableService

    def init = { servletContext -&gt;
        searchableService.stopMirroring()

        for (i in 0..&lt;10000) {
            def thingie = new Thingie(description: "this right here is a thingie and it's number ${i}")
            assert thingie.validate(), thingie.errors
            thingie.save()
        }

        searchableService.startMirroring()
        searchableService.indexAll()
    }

    def destroy = {
    }
}</pre>
</div>
</div>
<h3 id="_does_searchable_work_with_multiple_datasources" class="discrete">Does Searchable work with multiple datasources?</h3>
<div class="paragraph">
<p>It does, but you will need to add a few things to your application to get it working.</p>
</div>
<div class="paragraph">
<p>You will likely get the following error if you have multiple datasources, or a datasource with a non-default name (like <code>dataSource_users</code> ):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GrailsContextLoader Error initializing the application: No entities listed to be indexed, have you defined your entities correctly?
java.lang.IllegalArgumentException: No entities listed to be indexed, have you defined your entities correctly?</pre>
</div>
</div>
<div class="paragraph">
<p>To correct this issue, add the following to <code>resources.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.compass.gps.device.hibernate.HibernateGpsDevice
import grails.plugin.searchable.internal.compass.config.SessionFactoryLookup

beans = {
    compassGpsDevice(HibernateGpsDevice) { bean -&gt;
        bean.destroyMethod = "stop"
        name = "hibernate"
        sessionFactory = { SessionFactoryLookup sfl -&gt;
          sessionFactory = ref('sessionFactory_datasourceName')
        }
        fetchCount = 5000
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>To add other dataSources with indexable classes, add the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>anotherUniquecompassGpsDevice(HibernateGpsDevice) { bean -&gt;
    bean.destroyMethod = "stop"
    name = "unqiueHibernateName"
    sessionFactory = { SessionFactoryLookup sfl -&gt;
        sessionFactory = ref('sessionFactory_uniquedatasource')
    }
    fetchCount = 5000
  }</pre>
</div>
</div>
<div class="paragraph">
<p>And finally add&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.compass.gps.impl.SingleCompassGps

compassGps(SingleCompassGps) {
    compass = ref('compass')
    gpsDevices = [compassGpsDevice, anotherUniqueCompassGpsDevice]
}</pre>
</div>
</div>
<div class="paragraph">
<p>(Thanks to mydigitalbricks.blogspot.com for this fix. Read the original blog post <a href="http://mydigitalbricks.blogspot.com/2012/02/searching-multiple-data-sources-in.html">here</a>.)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_methods">Methods</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_search">search</h3>
<h4 id="_summary_6" class="discrete">Summary</h4>
<div class="paragraph">
<p>Finds domain object hits for a query.</p>
</div>
<h4 id="_syntax_6" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.search(String query)
searchableService.search(String query, Map options)
searchableService.search(Map options, String query) // same as previous
searchableService.search(Closure builder)
searchableService.search(Closure builder, Map options)
searchableService.search(Map options, Closure builder) // same as previous</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.search(String query)
DomainClass.search(String query, Map options)
DomainClass.search(Map options, String query) // same as previous
DomainClass.search(Closure builder)
DomainClass.search(Closure builder, Map options)
DomainClass.search(Map options, Closure builder) // same as previous</pre>
</div>
</div>
<h4 id="_description_6" class="discrete">Description</h4>
<div class="paragraph">
<p>Issues a query to the search engine and returns the result.</p>
</div>
<div class="paragraph">
<p>Normally that result ([return value|Searchable Plugin - Methods - search#Returns]) is a "search result" object, which contains a subset of hits and other data, but you can ask for a different result with the result option.</p>
</div>
<div class="paragraph">
<p>The query can be specified as either a [String|Searchable Plugin - Searching - String Queries] or
[Closure|Searchable Plugin - Searching - Query Builder] parameter.</p>
</div>
<div class="paragraph">
<p>[Options|Searchable Plugin - Methods - search#Options] can be provided to modify the query or result.</p>
</div>
<h4 id="_parameters_6" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong>query</strong> - A [query String|Searchable Plugin - Searching - String Queries]</p>
</li>
<li>
<p><strong>builder</strong> - A [query-buiding Closure|Searchable Plugin - Searching - Query Builder]</p>
</li>
<li>
<p><strong>options</strong> - A Map of [options|Searchable Plugin - Methods - search#Options]</p>
</li>
</ul>
</div>
<h5 id="_options_6" class="discrete">Options</h5>
<h6 id="_options_affecting_the_search_query" class="discrete">Options affecting the search query</h6>
<div class="ulist">
<ul>
<li>
<p><strong>sort</strong> - The field to sort results by (default is 'SCORE'). [More|Searchable Plugin - Searching - Sorting]</p>
</li>
<li>
<p><strong>order</strong> or <strong>direction</strong> - The sort order, only used with sort (default is 'auto'). [More|Searchable Plugin - Searching - Sorting]</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_options_for_string_queries">Options for String queries</h6>
<div class="ulist">
<ul>
<li>
<p><strong>escape</strong> - Should special characters be escaped? Default is false. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong>defaultProperty</strong> or <strong>defaultSearchProperty</strong> - The searchable property for un-prefixed terms. Default is "all". [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong>properties</strong> - The names of the class properties in which to search. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong>defaultOperator</strong> - Either "and" or "or". Default is "and" unless set otherwise elsewhere. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong>analyzer</strong> - The name of a query analyzer. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong>parser</strong> or <strong>queryParser</strong> - The name of a query parser. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
</ul>
</div>
<h6 id="_options_affecting_the_return_value" class="discrete">Options affecting the return value</h6>
<div class="ulist">
<ul>
<li>
<p><strong>result</strong> - What should the method return? If defined, one of "searchResult", "top", "every" or "count". Default is "searchResult". (See [Returns|Searchable Plugin - Methods - search#Returns] below)</p>
</li>
<li>
<p><strong>offset</strong> - The 0-based start result offset (default 0)</p>
</li>
<li>
<p><strong>max</strong> - The maximum number of results to return (default 10). Only used with result: "searchResult"</p>
</li>
<li>
<p><strong>reload</strong> - If true, reloads the objects from the database, attaching them to a Hibernate session, otherwise the objects are reconstructed from the index. Default is false</p>
</li>
<li>
<p><strong>withHighlighter</strong> - A Closure instance that is called for each search result hit to support highlighting. [More|Searchable Plugin - Searching - Highlighting]</p>
</li>
<li>
<p><strong>suggestQuery</strong> - Do you want a suggested query with that search result? If true or Map and result is undefined or "searchResult", adds a suggestedQuery property to the search result object. Use a Map value to define nested [suggestQuery options|Searchable Plugin - Methods - suggestQuery#options]. Use true to use the default [suggestQuery options|Searchable Plugin - Methods - suggestQuery#options].</p>
</li>
</ul>
</div>
<h4 id="_returns" class="discrete">Returns</h4>
<div class="paragraph">
<p>By default (if result is undefined) or if result is <strong>"searchResult"</strong>, returns a "search result" object containing a subset of objects matching the query, with the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>results</strong> - A List of matching domain objects</p>
</li>
<li>
<p><strong>scores</strong> - A List of scores: one for for each entry in <strong>results</strong></p>
</li>
<li>
<p><strong>total</strong> - The total number of hits</p>
</li>
<li>
<p><strong>offset</strong> - The 0-based hit object offset</p>
</li>
<li>
<p><strong>max</strong> - The maximum number of results <em>requested</em>. Note that this may be higher than results.size() if there were fewer hits than requested</p>
</li>
<li>
<p><strong>suggestedQuery</strong> - An alternative query String, based on spelling suggestions. <em>Only if suggestQuery is non-false</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If result is <strong>"every"</strong>, returns every domain object hit.</p>
</div>
<div class="paragraph">
<p>If result is <strong>"top"</strong>, returns the first domain object hit.</p>
</div>
<div class="paragraph">
<p>If result is <strong>"count"</strong>, returns the number of hits (as if you had used [countHits|Searchable Plugin - Methods - countHits]).</p>
</div>
<div class="paragraph">
<p>The order of the hits is either by relevance (the default) or [a sort you define|Searchable Plugin - Searching - Sorting].</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you prefer, you can use
* searchTop(&#8230;&#8203;) instead of search(result: 'top', &#8230;&#8203;)
* searchEvery(&#8230;&#8203;) instead of search(result: 'every', &#8230;&#8203;)
* countHits(&#8230;&#8203;) instead of search(result: 'count', &#8230;&#8203;)
</td>
</tr>
</table>
</div>
<h4 id="_examples_7" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Get the first page of up to 20 domain objects
// matching the query 'Chelsea Florist'
def searchResult = searchableService.search(
    "Chelsea Florist",
    [offset: 0, max: 20]
)
assert searchResult instanceof Map
println "${searchResult.total} hits:"
for (i in 0..&lt;searchResult.results.size()) {
    println "${searchResult.offset + i + 1}: " +
        "${searchResult.results[i].toString()} " +
        "(score ${searchResult.scores[i]})"
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Find the lowest priced product matching the query
// '(laser OR L.A.S.E.R.) beam'
def product = Product.search(
    "(laser OR L.A.S.E.R.) beam",
    [sort: 'price', order: 'asc', result: 'top']
)
assert product instanceof Product</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Get all Articles that contain the terms
// 'police' OR 'doughnut', giving a higher score
// to items matching 'doughnut', and load from DB
def articles = Article.search(
    "Police doughnut^2.0",
    [reload: true, result: 'every']
)
assert articles.each { it instanceof Product }</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Count the number of domain objects matching 'cow pie'
def count = searchableService.countHits("cow pie")
println "There are ${count} hits for query 'cow pie'"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Find other objects like the identified Book
def searchResult = searchableService.moreLikeThis(
    class: Book, id: 2l
)
assert searchResult instanceof Map
println "${searchResult?.results?.size()} similar items found"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Check the spelling in a query
def suggestedQuery = Song.suggestQuery("living on a preyer")
println "Did you mean ${suggestedQuery}?"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Get a "search result" object for the given
// closure-defined query across all
// searchable class instances
def searchResult = searchableService.search {
    fuzzy('name', 'lundon')
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Get every Book relevant to the closure-defined query and
// highlight the "title" and "summary" properties,
// keeping the highlights in a separate List
def highlights = []
def bookHighlighter = { highlighter, index, sr -&gt;
    highlights[index] = [
        title: highlighter.fragment("title"),
        summary: highlighter.fragment("summary")
    ]
}
def books = Book.search(result: 'every', withHighlighter: bookHighlighter) {
    gt('averageReview', 3)
    queryString('learning techniques')
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// With typical suggested query
def searchResult = searchableService.search("lambda", suggestQuery: true)
println "did you mean ${searchResult.suggestedQuery}?"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// With suggested query, non-default options
def searchResult = Recipie.search("bacon", suggestQuery: [escape: true, userFriendly: false])
println "did you mean ${searchResult.suggestedQuery}?"</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_counthits">countHits</h3>
<h4 id="_summary_7" class="discrete">Summary</h4>
<div class="paragraph">
<p>Get the number of hits for a query.</p>
</div>
<h4 id="_syntax_7" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.countHits(String query)
searchableService.countHits(String queryString, Map options)
searchableService.countHits(Map options, String queryString) // same as previous
searchableService.countHits(Closure builder)
searchableService.countHits(Closure builder, Map options)
searchableService.countHits(Map options, Closure builder) // same as previous</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.countHits(String query)
DomainClass.countHits(String queryString, Map options)
DomainClass.countHits(Map options, String queryString) // same as previous
DomainClass.countHits(Closure builder)
DomainClass.countHits(Closure builder, Map options)
DomainClass.countHits(Map options, Closure builder) // same as previous</pre>
</div>
</div>
<h4 id="_description_7" class="discrete">Description</h4>
<div class="paragraph">
<p>Issues a query to the search engine and returns the number of hits.</p>
</div>
<div class="paragraph">
<p>This method is just like @[search|Searchable Plugin - Methods - search]@, except that it always return the hit count rather than relevant class instances. In fact you can use @search(&#8230;&#8203;, result: 'count')@ and @countHits(&#8230;&#8203;)@ interchangably.</p>
</div>
<div class="paragraph">
<p>[Options|Searchable Plugin - Methods - countHits#Options] can be provided to modify the query.</p>
</div>
<h4 id="_parameters_7" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>queryString</code></strong> - A [query String|Searchable Plugin - Searching - String Queries]</p>
</li>
<li>
<p><strong><code>builderClosure</code></strong> - A [query-buiding Closure|Searchable Plugin - Searching - Query Builder]</p>
</li>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|Searchable Plugin - Methods - countHits#Options]</p>
</li>
</ul>
</div>
<h5 id="_options_7" class="discrete">Options</h5>
<h6 id="_options_for_string_queries_2" class="discrete">Options for String queries</h6>
<div class="ulist">
<ul>
<li>
<p><strong><code>escape</code></strong> - Should special characters be escaped? Default is @false@. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong><code>defaultProperty</code></strong> or <strong><code>defaultSearchProperty</code></strong> - The searchable property for un-prefixed terms. Default is @"all"@. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong><code>properties</code></strong> - The names of the class properties in which to search. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong><code>defaultOperator</code></strong> - Either <code>"and"</code> or <code>"or"</code>. Default is <code>"and"</code> unless set otherwise elsewhere. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong><code>analyzer</code></strong> - The name of a query analyzer. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
<li>
<p><strong><code>parser</code></strong> or <strong><code>queryParser</code></strong> - The name of a query parser. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
</ul>
</div>
<h4 id="_returns_2" class="discrete">Returns</h4>
<div class="paragraph">
<p>The number of hits for the query</p>
</div>
<h4 id="_examples_8" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// count hits across all searchable class instances
def count = searchableService.countHits("samuri")</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// count hits within Show instances,
// escaping reserved string query characters
def count = Show.countHits("CSI [Las Vegas]", escape: true)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// count hits across all searchable class instances
def count = searchableService.countHits("CSI [Miami]", [escape: true])</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// count hits across all searchable class instances
// defining the query with a builder closure
def count = searchableService.countHits {
    term("format", "MP3")
    multiPhrase("title") {
        add("Wrecking")
        add("Ball")
    }
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// count hits for Show instance with a query
// built with a closure
def count = Show.countHits {
    term("keywords", "crime")
    term("keywords", "drama")
    queryString("ongoing love interest subplot", [defaultSearchProperty: "notes"])
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_morelikethis">moreLikeThis</h3>
<h4 id="_summary_8" class="discrete">Summary</h4>
<div class="paragraph">
<p>Finds similar objects to the indicated searchable domain class instance.</p>
</div>
<h4 id="_syntax_8" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>domainObject.moreLikeThis()
domainObject.moreLikeThis(Map options)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.moreLikeThis(Map options)
DomainClass.moreLikeThis(Serializable id)
DomainClass.moreLikeThis(Serializable id, Map options)
DomainClass.moreLikeThis(DomainClass domainObject)
DomainClass.moreLikeThis(DomainClass domainObject, Map options)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>searchableService.moreLikeThis(Map options)
searchableService.moreLikeThis(Class domainClass, Serializable id)
searchableService.moreLikeThis(Class domainClass, Serializable id, Map options)
searchableService.moreLikeThis(DomainClass domainObject)
searchableService.moreLikeThis(DomainClass domainObject, Map options)</pre>
</div>
</div>
<h4 id="_description_8" class="discrete">Description</h4>
<div class="paragraph">
<p>Issues a "more-like-this" query to the search engine and returns the result.</p>
</div>
<div class="paragraph">
<p>Note that you do not create the more-like-this query, it is created by the search engine for a given searchable class instance. You <em>do</em> need to provide or identify the class instance though.</p>
</div>
<div class="paragraph">
<p>Conceptually (apart from the difference in the query) this method is like @[search|Searchable Plugin - Methods - search]@, and you could think of it like a specialised "search" for more-like-some-object.</p>
</div>
<div class="paragraph">
<p>Unsurprisingly then they share code and this method has many options in common with @[search|Searchable Plugin - Methods - search]@ itself, and also adds [more of its own|Searchable Plugin - Methods - moreLikeThis#Options].</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To use <code>moreLikeThis</code> you need to add <code>termVector</code> to the searchable domain class&#8217;s ["all" property mapping|Searchable Plugin - Mapping - all] and rebuild the index. See the [example here|Searchable Plugin - Mapping - all#Examples].
</td>
</tr>
</table>
</div>
<h4 id="_parameters_8" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>domainClass</code></strong> - The searchable domain class of the object to find more like</p>
</li>
<li>
<p><strong><code>id</code></strong> - The id of the searchable domain object to find more like</p>
</li>
<li>
<p><strong><code>domainObject</code></strong> - A searchable domain class instance to find more like</p>
</li>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|Searchable Plugin - Methods - moreLikeThis#Options]</p>
</li>
</ul>
</div>
<h5 id="_options_8" class="discrete">Options</h5>
<h6 id="_options_affecting_the_more_like_this_query" class="discrete">Options affecting the more-like-this query</h6>
<div class="ulist">
<ul>
<li>
<p><strong><code>sort</code></strong> - The field to sort results by (default is <code>'SCORE'</code>). [More|Searchable Plugin - Searching - Sorting]</p>
</li>
<li>
<p><strong><code>order</code></strong> or <strong><code>direction</code></strong> - The sort order, only used with <code>sort</code> (default is <code>'auto'</code>). [More|Searchable Plugin - Searching - Sorting]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you prefer you can identify the domain class instance with options alone:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>class</code></strong> - The searchable domain class to find more like. Not required for <code>DomainClass.moreLikeThis(&#8230;&#8203;)</code></p>
</li>
<li>
<p><strong><code>id</code></strong> - The searchable domain object identifier to find more like</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These options tweak the more-like-this query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>aliases</code></strong> - Exposes the Compass <code>aliases</code> option allowing you to narrow the search space by alias. A <code>List</code> of aliases, eg <code>\['post', 'comment'\]</code></p>
</li>
<li>
<p><strong><code>boost</code></strong> - Sets whether to boost terms in query based on "score" or not. <code>true</code> or <code>false</code></p>
</li>
<li>
<p><strong><code>maxNumTokensParsed</code></strong> - The maximum number of tokens to parse in each example doc field that is not stored with TermVector support</p>
</li>
<li>
<p><strong><code>maxQueryTerms</code></strong> - The maximum number of query terms that will be included in any generated query.</p>
</li>
<li>
<p><strong><code>maxWordLen</code></strong> - The maximum word length above which words will be ignored. Set this to <code>0</code> for no maximum word length. The default is <code>0</code>.</p>
</li>
<li>
<p><strong><code>minResourceFreq</code></strong> - The frequency at which words will be ignored which do not occur in at least this many resources. Defaults to <code>5</code></p>
</li>
<li>
<p><strong><code>minTermFreq</code></strong> - The frequency below which terms will be ignored in the source doc. Defaults to <code>2</code>.</p>
</li>
<li>
<p><strong><code>minWordLen</code></strong> - The minimum word length below which words will be ignored. Set this to <code>0</code> for no minimum word length. Default is <code>0</code>.</p>
</li>
<li>
<p><strong><code>properties</code></strong> - Limits the search to these class properties. A @List@ of property names, eg <code>\['post', 'title'\]</code>.</p>
</li>
<li>
<p><strong><code>stopWords</code></strong> - A <code>List</code> of words that are not considered when comparing items for similarity. This is used in addition to any stop-words your analyzer has</p>
</li>
<li>
<p><strong><code>subIndexes</code></strong> - A <code>List</code> of sub-indexes to search in, eg, <code>\['bookmark'\]</code></p>
</li>
</ul>
</div>
<h6 id="_options_affecting_the_return_value_2" class="discrete">Options affecting the return value</h6>
<div class="ulist">
<ul>
<li>
<p><strong><code>result</code></strong> - What should the method return? If defined, one of <code>"searchResult"</code>, <code>"top"</code>, <code>"every"</code> or <code>"count"</code>. Default is <code>"searchResult"</code>. (See [Returns|Searchable Plugin - Methods - moreLikeThis#Returns] below)</p>
</li>
<li>
<p><strong><code>offset</code></strong> - The 0-based start result offset (default 0)</p>
</li>
<li>
<p><strong><code>max</code></strong> - The maximum number of results to return (default 10). Only used with <code>result: "searchResult"</code></p>
</li>
<li>
<p><strong><code>reload</code></strong> - If <code>true</code>, reloads the objects from the database, attaching them to a Hibernate session, otherwise the objects are reconstructed from the index. Default is <code>false</code></p>
</li>
<li>
<p><strong><code>withHighlighter</code></strong> - A <code>Closure</code> instance that is called for each search result hit to support highlighting. [More|Searchable Plugin - Searching - Highlighting]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are also some [additional options for string queries|Searchable Plugin - Searching - String Queries#Advanced String Query Options].</p>
</div>
<h4 id="_returns_3" class="discrete">Returns</h4>
<div class="paragraph">
<p>By default (if <code>result</code> is undefined) or if <code>result</code> is <strong><code>"searchResult"</code></strong>, returns a "search result" object containing a subset of similar objects, with the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>results</code></strong> - A <code>List</code> of domain objects</p>
</li>
<li>
<p><strong><code>scores</code></strong> - A <code>List</code> of scores: one for for each entry in <strong>results</strong></p>
</li>
<li>
<p><strong><code>total</code></strong> - The total number of hits</p>
</li>
<li>
<p><strong><code>offset</code></strong> - The 0-based hit object offset</p>
</li>
<li>
<p><strong><code>max</code></strong> - The maximum number of results <em>requested</em>. Note that this may be higher than <code>results.size()</code> if there were fewer hits than requested</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>result</code> is <strong><code>"every"</code></strong>, returns every similar object.</p>
</div>
<div class="paragraph">
<p>If <code>result</code> is <strong><code>"top"</code></strong>, returns the first similar domain object.</p>
</div>
<div class="paragraph">
<p>If <code>result</code> is <strong><code>"count"</code></strong>, returns the number of similar domain objects.</p>
</div>
<div class="paragraph">
<p>The order of the hits is either by relevance (the default) or [a sort you define|Searchable Plugin - Searching - Sorting].</p>
</div>
<h4 id="_examples_9" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Get more like the identified Artist
def searchResult = searchableService.moreLikeThis(Artist, 101l)

assert searchResult instanceof Map
println "${searchResult.total} hits:"
for (i in 0..&lt;searchResult.results.size()) {
    println "${searchResult.offset + i + 1}: " +
        "${searchResult.results[i].toString()} " +
        "(score ${searchResult.scores[i]})"
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Find similar items to a Product
def products = product.moreLikeThis(result: 'every')
println "We can also recommend ${products.size()} other items"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Get a third page of more-like-this results for the
// Catalogue instance defined by options (rather than
// formal parameters)
def searchResult = searchableService.moreLikThis(
    class: Catalogue, id: 312l, offset: 20, max: 10
)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Get the most similar item to the given searchable class instance
def mostSimilar = searchableService.moreLikeThis(item, result: 'top')</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Get similar books to the instance identified with the
// the *id* option (rather than formal parameters),
// having the method return *all* hits, and
// saving highlights in an external List
def highlights = []
def bookHighlighter = { highlighter, index, sr -&gt;
    highlights[index] = [
        title: highlighter.fragment("title"),
        summary: highlighter.fragment("summary")
    ]
}
def books = Book.moreLikeThis(
    id: 20l, result: 'every', withHighlighter: bookHighlighter
)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_suggestquery">suggestQuery</h3>
<h4 id="_summary_9" class="discrete">Summary</h4>
<div class="paragraph">
<p>Suggest a new search query based on spelling</p>
</div>
<h4 id="_syntax_9" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.suggestQuery(String query)
searchableService.suggestQuery(String query, Map options)
searchableService.suggestQuery(Map options, String query) // same as previous</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.suggestQuery(String query)
DomainClass.suggestQuery(String query, Map options)
DomainClass.suggestQuery(Map options, String query) // same as previous</pre>
</div>
</div>
<h4 id="_description_9" class="discrete">Description</h4>
<div class="paragraph">
<p>Uses the spelling index to suggest an alternative query.</p>
</div>
<div class="paragraph">
<p>You need to add some sort of <code>spellCheck</code> mapping for domain classes/properties that you wish to include in spelling index, either at the [class level|Searchable Plugin - Mapping - Class Mapping] or [property level|Searchable Plugin - Mapping - Searchable Property].</p>
</div>
<div class="paragraph">
<p>You can programmatically [re-build the spelling index|Searchable Plugin - Methods - rebuildSpellingSuggestions] if you like. This might be useful for testing, but otherwise don&#8217;t worry, it is periodically refreshed automatically by Compass.</p>
</div>
<div class="paragraph">
<p>{info}</p>
</div>
<div class="paragraph">
<p>You can also call @[search|Searchable Plugin - Methods - search]@ with a <code>suggestQuery</code> @[option|Searchable Plugin - Methods - search#Options]@, which returns search results for the original query, along with a suggested query.
{info}</p>
</div>
<div class="paragraph">
<p>The plugin provides a helper class to highlight the different terms in the suggested vs original query, <em>a la</em> Google, etc. [More|Searchable Plugin - SearchableController and view#Suggested queries]</p>
</div>
<h4 id="_parameters_9" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>query</code></strong> - A [query String|Searchable Plugin - Searching - String Queries]</p>
</li>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|Searchable Plugin - Methods - suggestQuery#options]</p>
</li>
</ul>
</div>
<h5 id="_options_9" class="discrete">options</h5>
<h6 id="_options_affecting_the_search_query_2" class="discrete">Options affecting the search query</h6>
<div class="ulist">
<ul>
<li>
<p><strong><code>escape</code></strong> - Should special characters be escaped? Default is @false@. [More|Searchable Plugin - Searching - String Queries#Advanced String Query Options]</p>
</li>
</ul>
</div>
<h6 id="_options_affecting_the_return_value_3" class="discrete">Options affecting the return value</h6>
<div class="ulist">
<ul>
<li>
<p><strong><code>userFriendly</code></strong> - Should the suggested query look like a user-query? When @false@ returns queries as they are re-written and suggested by the search engine. Default is <code>true</code>.</p>
</li>
<li>
<p><strong><code>emulateCapitalisation</code></strong> - When <code>false</code> returns a query as re-written and suggested by the search engine, which is usually all lowercase, when <code>true</code> tries to emulate the upper-casing of the original query. Default is <code>true</code></p>
</li>
<li>
<p><strong><code>allowSame</code></strong> - Can the method return the same query as the given <code>query</code>? This is possible if no better suggestions are found. If <code>false</code>, the method returns <code>null</code> instead of allowing the same query. Default is <code>true</code></p>
</li>
</ul>
</div>
<h4 id="_returns_4" class="discrete">Returns</h4>
<div class="paragraph">
<p>A suggested query <code>String</code> or null</p>
</div>
<h4 id="_examples_10" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Get a suggested query, using all available class instances
// for spelling suggestions
def suggestedQuery = searchableService.suggestQuery("grate briton")
println "Did you mean ${suggestedQuery}"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Get a suggested query using only searchable text from "Player"
// instances for spelling suggestions, allowing for bad
// characters and disabling the user-friendly options
def suggestedQuery = Player.suggestQuery(
    "kartoon",
    escape: true, userFriendly: false, emulateCapitalisation: false
)
println "Did you mean ${suggestedQuery}"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_termfreqs">termFreqs</h3>
<h4 id="_summary_10" class="discrete">Summary</h4>
<div class="paragraph">
<p>Get <em>term frequencies</em> for the terms in the search index.</p>
</div>
<h4 id="_syntax_10" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.termFreqs()
searchableService.termFreqs(String propertyNames...)
searchableService.termFreqs(Map options, String propertyNames...)
searchableService.termFreqs(Map options)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.termFreqs()
DomainClass.termFreqs(String propertyNames...)
DomainClass.termFreqs(Map options, String propertyNames...)
DomainClass.termFreqs(Map options)</pre>
</div>
</div>
<h4 id="_description_10" class="discrete">Description</h4>
<div class="paragraph">
<p>{info:title=What&#8217;s a term frequency?}</p>
</div>
<div class="paragraph">
<p>A <em>term frequency</em> represents a <em>term</em> in the index (where a term is normally a word) and its <em>frequency</em> in the index (number of occurances).</p>
</div>
<div class="paragraph">
<p><em>Term frequencies</em> (often abbreviated to "term freqs") is just the plural of that, ie, a collection of terms and their respective frequencies.</p>
</div>
<div class="paragraph">
<p>With term frequencies you can discover which terms are more common and which are less common, or find out the exact number of occurances of each.
{info}</p>
</div>
<div class="paragraph">
<p>Term frequencies can be limited to the subset of class hierarchy, if called as a domain class static method or with a <code>class</code> option, and/or class properties, if the <code>propertyNames</code> parameter or <code>properties</code> option is provided.</p>
</div>
<div class="paragraph">
<p>You can also <em>normalize</em> the returned frequencies, which can make tag clouds easy, for example.</p>
</div>
<div class="paragraph">
<p><em>TODO show/link to tag cloud example</em></p>
</div>
<h4 id="_parameters_10" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>propertyNames</code></strong> - An arbitrary number of  domain class property names. If defined, only terms for these properties are returned</p>
</li>
<li>
<p><strong><code>options</code></strong> - A @Map@ of [options|Searchable Plugin - Methods - termFreqs#options]</p>
</li>
</ul>
</div>
<h5 id="_options_10" class="discrete">options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>properties</code></strong> - A <code>List</code> of property names; use this to get term freqs for multiple properties</p>
</li>
<li>
<p><strong><code>size</code></strong> - The maximum number of term freqs to return. Default is all</p>
</li>
<li>
<p><strong><code>normalise</code></strong> or <strong><code>normalize</code></strong> - A Groovy <code>Range</code> used to normalise the frequencies. Without this option the frequencies of the returned term freqs are the <em>actual</em> number of occurences for the term in the index.</p>
</li>
<li>
<p><strong><code>class</code></strong> - The class to restrict the term freqs to</p>
</li>
<li>
<p><strong><code>sort</code></strong> - Sorts the term frequencies; either <code>"term"</code> to sort alphabetically by term or <code>"freq"</code> to sort by highest frequency first. Default is <code>"freq"</code></p>
</li>
</ul>
</div>
<h4 id="_returns_5" class="discrete">Returns</h4>
<div class="paragraph">
<p>An <em>array</em> of <a href="http://www.compass-project.org/docs/2.1.0RC/api/org/compass/core/CompassTermFreq.html">CompassTermFreq</a>, each with the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>getTerm</code></strong> - returns the term</p>
</li>
<li>
<p><strong><code>getFreq</code></strong> - returns the frequency</p>
</li>
<li>
<p><strong><code>getProperty</code></strong> - returns the searchable property from which the term comes</p>
</li>
</ul>
</div>
<h4 id="_examples_11" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// print all Book term frequencies
def termFreqs = Book.termFreqs()
termFreqs.each {
    println "${it.term} occurs ${it.freq} times in the index for Book instances"
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// get Book term frequencies for Book#title
def termFreqs = Book.termFreqs("title")</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// get Book term frequencies for Book#title,
// limiting the size to 100 and normalising the frequencies
// between 0 (minimum) and 1 (maximum)
def termFreqs = Book.termFreqs("title", size: 100, normalize: 0..1)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// get terms from all properties in the index,
// sorting by term and limited to the Author class
def termFreqs = searchableService.search(class: Author, sort: "term")</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// get terms from searchable "title" and "description" properties
// in the index, limiting and normalsing
def termFreqs = searchableService.search(
    properties: ["title", "description"], size: 1000, normalise: 0..1
)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_index">index</h3>
<h4 id="_summary_11" class="discrete">Summary</h4>
<div class="paragraph">
<p>Indexes searchable class instances (adds them to the search index)</p>
</div>
<h4 id="_syntax_11" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>domainObject.index()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.index()
DomainClass.index(DomainClass instances...)
DomainClass.index(Serializable ids...)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>searchableService.index()
searchableService.index(Map options)
searchableService.index(DomainClass instances...)
searchableService.index(Serializable ids..)
searchableService.index(Map options, Serializable ids...)</pre>
</div>
</div>
<h4 id="_description_11" class="discrete">Description</h4>
<div class="paragraph">
<p>When called as a domain class instance method, indexes the instance.</p>
</div>
<div class="paragraph">
<p>When called as a domain class static method with no arguments, indexes all instances for that class (or hierarchy).</p>
</div>
<div class="paragraph">
<p>When called as a <code>SearchableService</code> method with no arguments, indexes all searchable class instances.</p>
</div>
<div class="paragraph">
<p>In other invocations, indexes the searchable class instances you provide or identify.</p>
</div>
<h4 id="_parameters_11" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>instances</code></strong> - One or more searchable class instances</p>
</li>
<li>
<p><strong><code>ids</code></strong> - One or more searchable class instance ids</p>
</li>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|Searchable Plugin - Methods - index#options]</p>
</li>
</ul>
</div>
<h5 id="_options_11" class="discrete">options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>class</code></strong> - a searchable class; use this option with the @SearchableService@ method and @ids@ parameter or as an alternative to the domain-class method</p>
</li>
</ul>
</div>
<h4 id="_returns_6" class="discrete">Returns</h4>
<div class="paragraph">
<p>No meaningful value</p>
</div>
<h4 id="_examples_12" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Index a Post instance
post.index()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Add some Menus to the index
Menu.index(m1, m2)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Add all Countries to the index
Country.index()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Index everything
searchableService.index()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Index the identified Book
searchableService.index(class: Book, 1l)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Index the given Tool
searchableService.index(tool)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unindex">unindex</h3>
<h4 id="_summary_12" class="discrete">Summary</h4>
<div class="paragraph">
<p>Un-indexes searchable class instances (removes them from the search index)</p>
</div>
<h4 id="_syntax_12" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>domainObject.unindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.unindex()
DomainClass.unindex(DomainClass instances...)
DomainClass.unindex(Serializable ids...)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>searchableService.unindex()
searchableService.unindex(Map options)
searchableService.unindex(DomainClass instances...)
searchableService.unindex(Serializable ids..)
searchableService.unindex(Map options, Serializable ids...)</pre>
</div>
</div>
<h4 id="_description_12" class="discrete">Description</h4>
<div class="paragraph">
<p>When called as a domain class instance method, un-indexes the instance.</p>
</div>
<div class="paragraph">
<p>When called as a domain class static method with no arguments, un-indexes all instances for that class (or hierarchy).</p>
</div>
<div class="paragraph">
<p>When called as a <code>SearchableService</code> method with no arguments, un-indexes all searchable class instances.</p>
</div>
<div class="paragraph">
<p>In other invocations, un-indexes the searchable class instances you provide or identify.</p>
</div>
<h4 id="_parameters_12" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>instances</code></strong> - One or more searchable class instances</p>
</li>
<li>
<p><strong><code>ids</code></strong> - One or more searchable class instance ids</p>
</li>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|Searchable Plugin - Methods - unindex#options]</p>
</li>
</ul>
</div>
<h5 id="_options_12" class="discrete">options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>class</code></strong> - a searchable class; use this option with the <code>SearchableService</code> method and <code>ids</code> parameter or as an alternative to the domain-class method</p>
</li>
</ul>
</div>
<h4 id="_returns_7" class="discrete">Returns</h4>
<div class="paragraph">
<p>No meaningful value</p>
</div>
<h4 id="_examples_13" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Unindex a Post instance
post.unindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Add some Menus to the index
Menu.unindex(m1, m2)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Add all Countries to the index
Country.unindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Unindex everything
searchableService.unindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Unindex the identified Book
searchableService.unindex(class: Book, 1l)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Unindex the given Tool
searchableService.unindex(tool)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reindex">reindex</h3>
<h4 id="_summary_13" class="discrete">Summary</h4>
<div class="paragraph">
<p>Re-indexes searchable class instances (refreshes them in the search index)</p>
</div>
<h4 id="_syntax_13" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>domainObject.reindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>DomainClass.reindex()
DomainClass.reindex(DomainClass instances...)
DomainClass.reindex(Serializable ids...)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>searchableService.reindex()
searchableService.reindex(Map options)
searchableService.reindex(DomainClass instances...)
searchableService.reindex(Serializable ids..)
searchableService.reindex(Map options, Serializable ids...)</pre>
</div>
</div>
<h4 id="_description_13" class="discrete">Description</h4>
<div class="paragraph">
<p>When called as a domain class instance method, re-indexes the instance.</p>
</div>
<div class="paragraph">
<p>When called as a domain class static method with no arguments, re-indexes all instances for that class (or hierarchy).</p>
</div>
<div class="paragraph">
<p>When called as a <code>SearchableService</code> method with no arguments, re-indexes all searchable class instances.</p>
</div>
<div class="paragraph">
<p>In other invocations, re-indexes the searchable class instances you provide or identify.</p>
</div>
<h4 id="_parameters_13" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>instances</code></strong> - One or more searchable class instances</p>
</li>
<li>
<p><strong><code>ids</code></strong> - One or more searchable class instance ids</p>
</li>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|Searchable Plugin - Methods - reindex#options]</p>
</li>
</ul>
</div>
<h5 id="_options_13" class="discrete">options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>class</code></strong> - a searchable class; use this option with the <code>SearchableService</code> method and <code>ids</code> parameter or as an alternative to the domain-class method</p>
</li>
</ul>
</div>
<h4 id="_returns_8" class="discrete">Returns</h4>
<div class="paragraph">
<p>No meaningful value</p>
</div>
<h4 id="_examples_14" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Reindex a Post instance
post.reindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Add some Menus to the index
Menu.reindex(m1, m2)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Add all Countries to the index
Country.reindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Reindex everything
searchableService.reindex()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Reindex the identified Book
searchableService.reindex(class: Book, 1l)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Reindex the given Tool
searchableService.reindex(tool)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rebuildspellingsuggestions">rebuildSpellingSuggestions</h3>
<h4 id="_summary_14" class="discrete">Summary</h4>
<div class="paragraph">
<p>Re-builds the spelling suggestions index</p>
</div>
<h4 id="_syntax_14" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.rebuildSpellingSuggestions()
searchableService.rebuildSpellingSuggestions(options)</pre>
</div>
</div>
<h4 id="_description_14" class="discrete">Description</h4>
<div class="paragraph">
<p>A spelling suggestions index is required to use [query suggestions|Searchable Plugin - Methods - suggestQuery].</p>
</div>
<div class="paragraph">
<p>This method allows you to re-build the spelling suggestions index(es) on demand.</p>
</div>
<div class="paragraph">
<p>The spelling suggestions feature is provided by Compass and normally takes care of itself. In other words, you do not need to re-build the spelling index in normal circumstances.</p>
</div>
<div class="paragraph">
<p>However it may be useful in certain scenarios, eg, in tests.</p>
</div>
<h4 id="_parameters_14" class="discrete">Parameters</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>options</code></strong> - A <code>Map</code> of [options|#Options]</p>
</li>
</ul>
</div>
<h5 id="_options_14" class="discrete">Options</h5>
<div class="ulist">
<ul>
<li>
<p><strong><code>fork</code></strong> - If <code>true</code>, forks a new thread and returns immediately. May not be used with <code>subIndex</code>. Default is <code>false</code>, in which case the method only returns when the re-build is finished</p>
</li>
<li>
<p><strong><code>subIndex</code></strong> - The sub-index of a searchable class to re-build the spelling suggestions for. May not be used with <code>fork</code>. Default is to re-build the spelling suggestions indexes for all classes.</p>
</li>
</ul>
</div>
<h4 id="_examples_15" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>// Rebuild in a backgroudn thread
searchableService.rebuildSpellingSuggestions(fork: true)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>// Rebuild for just one sub-index (maps to one class hierarchy)
searchableService.rebuildSpellingSuggestions(subIndex: "House")</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_startmirroring">startMirroring</h3>
<h4 id="_summary_15" class="discrete">Summary</h4>
<div class="paragraph">
<p>Starts the mirror-changes service</p>
</div>
<h4 id="_syntax_15" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.startMirroring()</pre>
</div>
</div>
<h4 id="_description_15" class="discrete">Description</h4>
<div class="paragraph">
<p>By default changes made through GORM/Hibernate are mirrored to the search index.</p>
</div>
<div class="paragraph">
<p>If you have disabled this feature in the <a href="index.html#_configuration">configuration</a>, or if you previously [stopped the mirror-changes service|Searchable Plugin - Methods - stopMirroring], you can start it with this method.</p>
</div>
<h4 id="_examples_16" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.startMirroring()</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stopmirroring">stopMirroring</h3>
<h4 id="_summary_16" class="discrete">Summary</h4>
<div class="paragraph">
<p>Stops the mirror-changes service</p>
</div>
<h4 id="_syntax_16" class="discrete">Syntax</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.stopMirroring()</pre>
</div>
</div>
<h4 id="_description_16" class="discrete">Description</h4>
<div class="paragraph">
<p>By default changes made through GORM/Hibernate are mirrored to the search index.</p>
</div>
<div class="paragraph">
<p>This feature can be controlled by <a href="index.html#_configuration">configuration</a>, but this method allows you to stop mirroring changes.</p>
</div>
<div class="paragraph">
<p>You can start mirroring changes again with the [startMirroring|Searchable Plugin - Methods - startMirroring] method.</p>
</div>
<h4 id="_examples_17" class="discrete">Examples</h4>
<div class="listingblock">
<div class="content">
<pre>searchableService.stopMirroring()</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_releases">Releases</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-02-24 11:13:55 +01:00
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>